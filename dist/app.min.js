var __decorate=this&&this.__decorate||function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;0<=l;l--)(i=e[l])&&(r=(s<3?i(r):3<s?i(t,n,r):i(t,n))||r);return 3<s&&r&&Object.defineProperty(t,n,r),r},__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();System.register("enums/appEvent",[],function(t,e){"use strict";var n;e&&e.id;return{setters:[],execute:function(){var e;(e=n||(n={}))[e.Select=0]="Select",e[e.MouseMove=1]="MouseMove",e[e.Delete=2]="Delete",e[e.Load=3]="Load",e[e.More=4]="More",t("AppEvent",n)}}}),System.register("dispatcher",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function o(){}return o.subscribe=function(e){o.subscribers.push(e)},o.unsubscribe=function(e){o.subscribers.splice(o.subscribers.indexOf(e),1)},o.notify=function(e,t){for(var n=0;n<o.subscribers.length;n++)o.subscribers[n].notify(e,t)},o.subscribers=new Array,o}(),e("Dispatcher",n)}}}),System.register("io/xmlMap",[],function(e,t){"use strict";var s,r;t&&t.id;return e("Xml",function(n,o,i){return function(e,t){r.addField(e,t,n,o,i)}}),{setters:[],execute:function(){s=function(){function e(e,t,n,o,i){this.klass=e,this.property=t,this.path=n,this.defaultValue=o,this.transform=i}return e.prototype.load=function(e,t){var n=t.getAttribute(this.path);n||(n=this.defaultValue),this.transform&&(n=this.transform(n)),e[this.property]=n},e}(),r=function(){function e(){}return e.addField=function(e,t,n,o,i){this.fields.push(new s(e,t,n,o,i))},e.load=function(t,n){this.fields.forEach(function(e){t instanceof e.klass.constructor&&e.load(t,n)})},e.fields=new Array,e}(),e("XmlMap",r)}}}),System.register("models/model",["dispatcher","enums/appEvent","io/xmlMap"],function(e,t){"use strict";var n,o,i,s;t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e}],execute:function(){s=function(){function e(){this.id=0}return e.prototype.getType=function(){return this.type},e.prototype.delete=function(){this.map.remove(this),n.Dispatcher.notify(o.AppEvent.Delete,this)},e.prototype.cloneToTarget=function(e){for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},e.prototype.clone=function(){return null},e.prototype.bringToFront=function(){this.map.bringToFront(this)},e.prototype.bringForward=function(){this.map.bringForward(this)},e.prototype.sendBackward=function(){this.map.sendBackward(this)},e.prototype.sendToBack=function(){this.map.sendToBack(this)},__decorate([i.Xml("id",0,function(e){return parseInt(e)})],e.prototype,"id",void 0),e}(),e("Model",s)}}}),System.register("enums/direction",[],function(n,e){"use strict";var o;e&&e.id;return{setters:[],execute:function(){var e,t;(e=o||(o={}))[e.N=0]="N",e[e.NNE=1]="NNE",e[e.NE=2]="NE",e[e.ENE=3]="ENE",e[e.E=4]="E",e[e.ESE=5]="ESE",e[e.SE=6]="SE",e[e.SSE=7]="SSE",e[e.S=8]="S",e[e.SSW=9]="SSW",e[e.SW=10]="SW",e[e.WSW=11]="WSW",e[e.W=12]="W",e[e.WNW=13]="WNW",e[e.NW=14]="NW",e[e.NNW=15]="NNW",n("Direction",o),(t=o||(o={})).opposite=function(e){switch(e){case t.N:return t.S;case t.NNE:return t.SSW;case t.NE:return t.SW;case t.ENE:return t.WSW;case t.E:return t.W;case t.ESE:return t.WNW;case t.SE:return t.NW;case t.SSE:return t.NNW;case t.S:return t.N;case t.SSW:return t.NNE;case t.SW:return t.NE;case t.WSW:return t.ENE;case t.W:return t.E;case t.WNW:return t.ESE;case t.NW:return t.SE;case t.NNW:return t.SSE}},t.isCardinal=function(e){switch(e){case t.N:case t.NE:case t.E:case t.SE:case t.S:case t.SW:case t.W:case t.NW:return!0}return!1},t.toCardinalVector=function(e){switch(e){case t.N:case t.NNE:return{x:0,y:-1};case t.NE:return{x:1,y:-1};case t.ENE:case t.E:case t.ESE:return{x:1,y:0};case t.SE:return{x:1,y:1};case t.SSE:case t.S:case t.SSW:return{x:0,y:1};case t.SW:return{x:-1,y:1};case t.WSW:case t.W:case t.WNW:return{x:-1,y:0};case t.NW:return{x:-1,y:-1};case t.NNW:return{x:0,y:-1}}},t.toVector=function(e){switch(e){case t.N:return{x:0,y:-1};case t.NNE:return{x:.5,y:-1};case t.NE:return{x:1,y:-1};case t.ENE:return{x:1,y:-.5};case t.E:return{x:1,y:0};case t.ESE:return{x:1,y:.5};case t.SE:return{x:1,y:1};case t.SSE:return{x:.5,y:1};case t.S:return{x:0,y:1};case t.SSW:return{x:-.5,y:1};case t.SW:return{x:-1,y:1};case t.WSW:return{x:-1,y:.5};case t.W:return{x:-1,y:0};case t.WNW:return{x:-1,y:-.5};case t.NW:return{x:-1,y:-1};case t.NNW:return{x:-.5,y:-1}}},t.toRadians=function(e){switch(e){case t.N:return 12*Math.PI/8;case t.NNE:return 13*Math.PI/8;case t.NE:return 14*Math.PI/8;case t.ENE:return 15*Math.PI/8;case t.E:return 0*Math.PI/8;case t.ESE:return 1*Math.PI/8;case t.SE:return 2*Math.PI/8;case t.SSE:return 3*Math.PI/8;case t.S:return 4*Math.PI/8;case t.SSW:return 5*Math.PI/8;case t.SW:return 6*Math.PI/8;case t.WSW:return 7*Math.PI/8;case t.W:return 8*Math.PI/8;case t.WNW:return 9*Math.PI/8;case t.NW:return 10*Math.PI/8;case t.NNW:return 11*Math.PI/8}},t.toCursor=function(e){switch(e){case t.N:return"n-resize";case t.NE:return"ne-resize";case t.E:return"e-resize";case t.SE:return"se-resize";case t.S:return"s-resize";case t.SW:return"sw-resize";case t.W:return"w-resize";case t.NW:return"nw-resize"}},t.fromString=function(e){return"n"==(e=e.toLowerCase())?t.N:"nne"==e?t.NNE:"ne"==e?t.NE:"ene"==e?t.ENE:"e"==e?t.E:"ese"==e?t.ESE:"se"==e?t.SE:"sse"==e?t.SSE:"s"==e?t.S:"ssw"==e?t.SSW:"sw"==e?t.SW:"wsw"==e?t.WSW:"w"==e?t.W:"wnw"==e?t.WNW:"nw"==e?t.NW:"nnw"==e?t.NNW:void 0},n("Direction",o)}}}),System.register("enums/connectorHandle",[],function(t,e){"use strict";var n;e&&e.id;return{setters:[],execute:function(){var e;(e=n||(n={}))[e.Start=0]="Start",e[e.End=1]="End",t("ConnectorHandle",n)}}}),System.register("enums/connectorType",[],function(n,e){"use strict";var o;e&&e.id;return{setters:[],execute:function(){var e,t;(e=o||(o={}))[e.Default=0]="Default",e[e.In=1]="In",e[e.Out=2]="Out",e[e.Up=3]="Up",e[e.Down=4]="Down",n("ConnectorType",o),(t=o||(o={})).toString=function(e){switch(e){case t.In:return"in";case t.Out:return"out";case t.Up:return"u";case t.Down:return"d";default:return""}},n("ConnectorType",o)}}}),System.register("enums/lineStyle",[],function(n,e){"use strict";var o;e&&e.id;return{setters:[],execute:function(){var e,t;(e=o||(o={}))[e.None=0]="None",e[e.Solid=1]="Solid",e[e.Dash=2]="Dash",e[e.DashDot=3]="DashDot",e[e.DashDotDot=4]="DashDotDot",e[e.Dot=5]="Dot",n("LineStyle",o),(t=o||(o={})).fromString=function(e){return"none"==(e=e.toLowerCase())?t.None:"solid"==e?t.Solid:"dash"==e?t.Dash:"dashdot"==e?t.DashDot:"dashdotdot"==e?t.DashDotDot:"dot"==e?t.Dot:void 0},t.toArray=function(e){switch(e){case t.Solid:return[];case t.Dash:return[8,4];case t.DashDot:return[4,4];case t.DashDotDot:return[2,3];case t.Dot:return[3,2,2,2,4,2,2,2,3,2]}return[]},n("LineStyle",o)}}}),System.register("enums/mouseMode",[],function(t,e){"use strict";var n;e&&e.id;return{setters:[],execute:function(){var e;(e=n||(n={}))[e.None=0]="None",e[e.Select=1]="Select",e[e.Drag=2]="Drag",e[e.Resize=3]="Resize",e[e.Connect=4]="Connect",e[e.Scroll=5]="Scroll",e[e.AddRoom=6]="AddRoom",e[e.AddNote=7]="AddNote",e[e.AddBlock=8]="AddBlock",t("MouseMode",n)}}}),System.register("enums/roomShape",[],function(t,e){"use strict";var n;e&&e.id;return{setters:[],execute:function(){var e;(e=n||(n={}))[e.Rectangle=0]="Rectangle",e[e.Ellipse=1]="Ellipse",e[e.Octagon=2]="Octagon",t("RoomShape",n)}}}),System.register("enums/values",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(){}return e.ZOOM_FRACTION=1.2,e.ZOOM_ADDITIVE=.5,e.COLOR_TRANSPARENT="rgba(0,0,0,0.004)",e.COLOR_LINE="#000000",e.COLOR_SELECTED_GLOW="rgba(255,215,0,0.5)",e.COLOR_SELECTED="rgb(255,215,0)",e.COLOR_HOVER="#FF8C00",e.COLOR_CONNECTOR="rgba(135, 206, 235, 0.5)",e.COLOR_CONNECTOR_HIGHLIGHT="rgb(255,215,0)",e.COLOR_RESIZE="rgba(135, 206, 235, 0.5)",e.COLOR_RESIZE_HIGHLIGHT="rgb(255,215,0)",e.COLOR_SELECTION_LINE="#292B71",e.COLOR_SELECTION_AREA="rgba(41, 43, 113, 0.4)",e.COLOR_STARTROOM="green",e.COLOR_ENDROOM="red",e.COLORS_STANDARD=["#FFFFFF","#D5E5D6","#D0E0F2","#F6D5D5","#F8DFD0","#E0DDF6","#DFDFDF","#CCCCCC","#333333","#000000"],e.DIMEN_ROOM_MIN_WIDTH=64,e.DIMEN_ROOM_MIN_HEIGHT=32,e.DIMEN_ROOM_MARGIN=6,e.DIMEN_STARTROOM_MARGIN=3,e.DIMEN_RESIZE_HANDLE=6,e.DIMEN_CONNECTOR_HANDLE=5,e.BITMAP_ASSETS=["paper","metal","wood"],e}(),e("Values",n)}}}),System.register("enums/enums",["enums/appEvent","enums/direction","enums/connectorHandle","enums/connectorType","enums/lineStyle","enums/mouseMode","enums/roomShape","enums/values"],function(o,e){"use strict";e&&e.id;function t(e){var t={};for(var n in e)"default"!==n&&(t[n]=e[n]);o(t)}return{setters:[function(e){t(e)},function(e){t(e),t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)}],execute:function(){}}}),System.register("models/mapSettings",["enums/enums"],function(e,t){"use strict";var n,o,i,s,r,l;t&&t.id;return{setters:[function(e){n=e}],execute:function(){o=function(){this.visible=!0,this.origin=!0,this.snap=!0,this.size=32,this.color="#f0f0f0",this.lineWidth=1,this.originWidth=5},i=function(){this.width=96,this.height=64,this.margin=6,this.lineWidth=1,this.lineStyle=n.LineStyle.Solid,this.shape=n.RoomShape.Rectangle,this.rounding=0,this.darknessSize=50,this.fillColor="#ffffff",this.borderColor="#000000",this.nameColor="#333333",this.subtitleColor="#666666",this.darkColor="rgba(33, 35, 97, 0.8)",this.startRoomColor="green",this.endRoomColor="red"},s=function(){this.lineWidth=1,this.lineStyle=n.LineStyle.Solid,this.isCurve=!1,this.color="#000000",this.stalk=16,this.arrowSize=5,this.curveStrength=.4,this.labelDistance=12},r=function(){this.minWidth=64,this.minHeight=32,this.width=96,this.height=64,this.margin=6,this.lineWidth=1,this.lineStyle=n.LineStyle.Solid,this.shape=n.RoomShape.Rectangle,this.rounding=0,this.fillColor="#ffffff",this.borderColor="#000000",this.textColor="#333333"},l=function(){this.minWidth=64,this.minHeight=32,this.width=96,this.height=64,this.margin=6,this.lineWidth=1,this.lineStyle=n.LineStyle.None,this.shape=n.RoomShape.Rectangle,this.rounding=0,this.fillColor="#D5E5D6",this.borderColor="#000000"},e("MapSettings",function(){this.grid=new o,this.room=new i,this.connector=new s,this.note=new r,this.block=new l,this.background="wood"})}}}),System.register("models/box",["models/model","enums/enums"],function(e,t){"use strict";var n,p,o;t&&t.id;return{setters:[function(e){n=e},function(e){p=e}],execute:function(){o=function(n){function e(e){var t=n.call(this)||this;return t.x=0,t.y=0,t}return __extends(e,n),Object.defineProperty(e.prototype,"fillColor",{get:function(){return this._fillColor},set:function(e){this._fillColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borderColor",{get:function(){return this._borderColor},set:function(e){this._borderColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rounding",{get:function(){return this._rounding},set:function(e){this._rounding=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){return this._shape},set:function(e){this._shape=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return this._lineStyle},set:function(e){this._lineStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(e){this._lineWidth=e},enumerable:!0,configurable:!0}),e.prototype.directionToPos=function(e,t){var n=0,o=0;if(this.shape==p.RoomShape.Rectangle||t){var i=p.Direction.toVector(e),s=i.x,r=i.y;n=Math.floor(s*(this.width/2)+this.width/2)+this.x,o=Math.floor(r*(this.height/2)+this.height/2)+this.y;var l=this.rounding;l>.25*this.width&&(l=.25*this.width),l>.25*this.height&&(l=.25*this.height);var a=l-Math.sqrt(l*l/2);e==p.Direction.NW&&(n+=a,o+=a),e==p.Direction.NE&&(n-=a,o+=a),e==p.Direction.SE&&(n-=a,o-=a),e==p.Direction.SW&&(n+=a,o-=a)}else if(this.shape==p.RoomShape.Ellipse)n=Math.floor(Math.cos(p.Direction.toRadians(e))*(this.width/2)+this.width/2)+this.x,o=Math.floor(Math.sin(p.Direction.toRadians(e))*(this.height/2)+this.height/2)+this.y;else if(this.shape==p.RoomShape.Octagon){var c=p.Direction.toVector(e);s=c.x,r=c.y;1==Math.abs(s)&&1==Math.abs(r)&&(s*=.75,r*=.75),n=Math.floor(s*(this.width/2)+this.width/2)+this.x,o=Math.floor(r*(this.height/2)+this.height/2)+this.y}return{x:n,y:o}},e}(n.Model),e("Box",o)}}}),System.register("models/connector",["models/model","enums/enums","models/mapSettings","enums/connectorType"],function(e,t){"use strict";var n,o,i,s,r;t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e},function(e){s=e}],execute:function(){r=function(n){function e(e){var t=n.call(this)||this;return t.type="Connector",t.name="",t.dockStart=null,t.dockEnd=null,t.startDir=o.Direction.N,t.endDir=o.Direction.S,t.startX=t.startY=0,t.endX=t.endY=0,t.oneWay=!1,t.startType=s.ConnectorType.Default,t.endType=s.ConnectorType.Default,t.startLabel="",t.endLabel="",t}return __extends(e,n),Object.defineProperty(e.prototype,"color",{get:function(){return null!=this._color?this._color:this.map.settings.connector.color},set:function(e){this._color=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return null!=this._lineStyle?this._lineStyle:this.map.settings.connector.lineStyle},set:function(e){this._lineStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return null!=this._lineWidth?this._lineWidth:this.map.settings.connector.lineWidth},set:function(e){this._lineWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCurve",{get:function(){return null!=this._isCurve?this._isCurve:this.map.settings.connector.isCurve},set:function(e){this._isCurve=e},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){var e,t;this.isDoubleDocked()&&(e=[this.dockStart,this.dockEnd],this.dockEnd=e[0],this.dockStart=e[1],t=[this.startDir,this.endDir],this.endDir=t[0],this.startDir=t[1])},e.prototype.isDoubleDocked=function(){return this.dockStart&&this.dockEnd},e.prototype.clone=function(){return this.cloneToTarget(new e(new i.MapSettings))},e}(n.Model),e("Connector",r)}}}),System.register("models/room",["models/box","models/mapSettings","models/connector"],function(e,t){"use strict";var n,o,i,s;t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e}],execute:function(){s=function(n){function e(e){var t=n.call(this,e)||this;return t.type="Room",t.name="Room",t.subtitle="",t.description="",t.dark=!1,t.endroom=!1,t.width=e.room.width,t.height=e.room.height,t}return __extends(e,n),Object.defineProperty(e.prototype,"nameColor",{get:function(){return this._nameColor?this._nameColor:this.map.settings.room.nameColor},set:function(e){this._nameColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subtitleColor",{get:function(){return this._subtitleColor?this._subtitleColor:this.map.settings.room.subtitleColor},set:function(e){this._subtitleColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillColor",{get:function(){return this._fillColor?this._fillColor:this.map.settings.room.fillColor},set:function(e){this._fillColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borderColor",{get:function(){return this._borderColor?this._borderColor:this.map.settings.room.borderColor},set:function(e){this._borderColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rounding",{get:function(){return null!=this._rounding?this._rounding:this.map.settings.room.rounding},set:function(e){this._rounding=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){return null!=this._shape?this._shape:this.map.settings.room.shape},set:function(e){this._shape=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return null!=this._lineStyle?this._lineStyle:this.map.settings.room.lineStyle},set:function(e){this._lineStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return null!=this._lineWidth?this._lineWidth:this.map.settings.room.lineWidth},set:function(e){this._lineWidth=e},enumerable:!0,configurable:!0}),e.prototype.isStartRoom=function(){return this.map.startRoom==this},e.prototype.setStartRoom=function(e){e?this.map.setStartRoom(this):this.isStartRoom()&&this.map.setStartRoom(null)},e.prototype.hasConnection=function(t){var n=this,o=!1;return this.map.elements.forEach(function(e){e instanceof i.Connector&&(e.dockStart==n&&e.startDir==t&&(o=!0),e.dockEnd==n&&e.endDir==t&&(o=!0))}),o},e.prototype.clone=function(){return this.cloneToTarget(new e(new o.MapSettings))},e}(n.Box),e("Room",s)}}}),System.register("models/map",["models/mapSettings"],function(e,t){"use strict";var n,o;t&&t.id;return{setters:[function(e){n=e}],execute:function(){o=function(){function e(){this.settings=new n.MapSettings,this.title="Untitled map",this.author="",this.description="",this.elements=new Array,this.startRoom=null}return e.prototype.clear=function(){this.elements.length=0},e.prototype.add=function(e){this.elements.push(e),e.map=this},e.prototype.remove=function(e){e==this.startRoom&&(this.startRoom=null),this.elements.splice(this.elements.indexOf(e),1)},e.prototype.findById=function(e,t){for(var n=0;n<this.elements.length;n++)if(this.elements[n]instanceof t&&this.elements[n].id==e)return this.elements[n]},e.prototype.setStartRoom=function(e){this.startRoom=e},e.prototype.bringToFront=function(e){var t=this.elements.indexOf(e);this.elements.splice(t,1),this.elements.push(e)},e.prototype.bringForward=function(e){var t=this.elements.indexOf(e);t>=this.elements.length||(this.elements.splice(t,1),this.elements.splice(t+1,0,e))},e.prototype.sendBackward=function(e){var t=this.elements.indexOf(e);t<=0||(this.elements.splice(t,1),this.elements.splice(t-1,0,e))},e.prototype.sendToBack=function(e){var t=this.elements.indexOf(e);this.elements.splice(t,1),this.elements.unshift(e)},e}(),e("Map",o)}}}),System.register("drawing/IScreen",[],function(i,e){"use strict";var s,r,l,a;e&&e.id;return{setters:[],execute:function(){var e,t,n,o;(e=s||(s={}))[e.Butt=0]="Butt",e[e.Round=1]="Round",e[e.Square=2]="Square",i("CapStyle",s),(t=r||(r={}))[t.Miter=0]="Miter",t[t.Round=1]="Round",t[t.Bevel=2]="Bevel",i("JoinStyle",r),(n=l||(l={}))[n.Start=0]="Start",n[n.End=1]="End",n[n.Left=2]="Left",n[n.Right=3]="Right",n[n.Center=4]="Center",i("TextAlign",l),(o=a||(a={}))[o.Alphabetic=0]="Alphabetic",o[o.Top=1]="Top",o[o.Hanging=2]="Hanging",o[o.Middle=3]="Middle",o[o.Ideographic=4]="Ideographic",o[o.Bottom=5]="Bottom",i("TextBaseline",a)}}}),System.register("views/view",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(){this.selected=!1}return e.prototype.getModel=function(){return null},e.prototype.draw=function(e,t,n,o,i){},e.prototype.drawHandles=function(e,t,n,o,i){},e.prototype.isSelected=function(){return this.selected},e.prototype.select=function(){this.selected=!0},e.prototype.unselect=function(){this.selected=!1},e.prototype.isIn=function(e,t,n,o){return!1},e}(),e("View",n)}}}),System.register("drawing/canvas",["drawing/IScreen","enums/enums"],function(e,t){"use strict";var h,n,o;t&&t.id;return{setters:[function(e){h=e},function(e){n=e}],execute:function(){o=function(){function e(e){this.ctx=e}return e.prototype.save=function(){return this.ctx.save(),this},e.prototype.restore=function(){return this.ctx.restore(),this},e.prototype.translate=function(e,t){return this.ctx.translate(e,t),this},e.prototype.rotate=function(e){return this.ctx.rotate(e),this},e.prototype.scale=function(e,t){return void 0===t&&(t=e),this.ctx.scale(e,t),this},e.prototype.moveTo=function(e,t){return this.ctx.moveTo(e,t),this},e.prototype.beginPath=function(){return this.ctx.beginPath(),this},e.prototype.closePath=function(){return this.ctx.closePath(),this},e.prototype.stroke=function(){return this.ctx.stroke(),this},e.prototype.fill=function(){return this.ctx.fill(),this},e.prototype.fillStyle=function(e){return this.ctx.fillStyle=e,this},e.prototype.strokeStyle=function(e){return this.ctx.strokeStyle=e,this},e.prototype.fillRect=function(e,t,n,o){return this.ctx.fillRect(e,t,n,o),this},e.prototype.strokeRect=function(e,t,n,o){return this.ctx.strokeRect(e,t,n,o),this},e.prototype.clearRect=function(e,t,n,o){return this.ctx.clearRect(e,t,n,o),this},e.prototype.lineWidth=function(e){return this.ctx.lineWidth=e,this},e.prototype.lineCap=function(e){switch(e){case h.CapStyle.Butt:this.ctx.lineCap="butt";break;case h.CapStyle.Round:this.ctx.lineCap="round";break;case h.CapStyle.Square:this.ctx.lineCap="square"}return this},e.prototype.lineJoin=function(e){switch(e){case h.JoinStyle.Miter:this.ctx.lineJoin="miter";break;case h.JoinStyle.Round:this.ctx.lineJoin="round";break;case h.JoinStyle.Bevel:this.ctx.lineJoin="bevel"}return this},e.prototype.lineDash=function(e){switch(e){case n.LineStyle.Solid:this.ctx.setLineDash([]);break;case n.LineStyle.Dash:this.ctx.setLineDash([8,4]);break;case n.LineStyle.DashDot:this.ctx.setLineDash([4,4]);break;case n.LineStyle.DashDotDot:this.ctx.setLineDash([2,3]);break;case n.LineStyle.Dot:this.ctx.setLineDash([3,2,2,2,4,2,2,2,3,2])}return this},e.prototype.lineTo=function(e,t){return this.ctx.lineTo(e,t),this},e.prototype.line=function(e,t,n,o){return this.ctx.moveTo(e,t),this.ctx.lineTo(n,o),this},e.prototype.arc=function(e,t,n,o,i,s){return this.ctx.arc(e,t,n,o,i,s||!1),this},e.prototype.arcTo=function(e,t,n,o,i){return this.ctx.arcTo(e,t,n,o,i),this},e.prototype.ellipse=function(e,t,n,o){var i=n/2*.5522848,s=o/2*.5522848,r=e+n,l=t+o,a=e+n/2,c=t+o/2;return this.beginPath().moveTo(e,c).bezierCurveTo(e,c-s,a-i,t,a,t).bezierCurveTo(a+i,t,r,c-s,r,c).bezierCurveTo(r,c+s,a+i,l,a,l).bezierCurveTo(a-i,l,e,c+s,e,c),this},e.prototype.roundedRect=function(e,t,n,o,i){return n<4*i&&(i=n/4),o<4*i&&(i=o/4),this.beginPath().moveTo(e+i,t).arcTo(e+n,t,e+n,t+o,i).arcTo(e+n,t+o,e,t+o,i).arcTo(e,t+o,e,t,i).arcTo(e,t,e+n,t,i).closePath(),this},e.prototype.octagon=function(e,t,n,o){return this.beginPath().moveTo(e,t+.25*o).lineTo(e+.25*n,t).lineTo(e+.75*n,t).lineTo(e+n,t+.25*o).lineTo(e+n,t+.75*o).lineTo(e+.75*n,t+o).lineTo(e+.25*n,t+o).lineTo(e,t+.75*o).closePath(),this},e.prototype.quadraticCurveTo=function(e,t,n,o){return this.ctx.quadraticCurveTo(e,t,n,o),this},e.prototype.getQuadraticXY=function(e,t,n,o,i,s,r){return{x:(1-e)*(1-e)*t+2*(1-e)*e*o+e*e*s,y:(1-e)*(1-e)*n+2*(1-e)*e*i+e*e*r}},e.prototype.getQuadraticAngle=function(e,t,n,o,i,s,r){var l=2*(1-e)*(o-t)+2*e*(s-o),a=2*(1-e)*(i-n)+2*e*(r-i);return-Math.atan2(l,a)+.5*Math.PI},e.prototype.bezierCurveTo=function(e,t,n,o,i,s){return this.ctx.bezierCurveTo(e,t,n,o,i,s),this},e.prototype.getBezierXY=function(e,t,n,o,i,s,r,l,a){return{x:Math.pow(1-e,3)*t+3*e*Math.pow(1-e,2)*o+3*e*e*(1-e)*s+e*e*e*l,y:Math.pow(1-e,3)*n+3*e*Math.pow(1-e,2)*i+3*e*e*(1-e)*r+e*e*e*a}},e.prototype.getBezierAngle=function(e,t,n,o,i,s,r,l,a){var c=Math.pow(1-e,2)*(o-t)+2*e*(1-e)*(s-o)+e*e*(l-s),p=Math.pow(1-e,2)*(i-n)+2*e*(1-e)*(r-i)+e*e*(a-r);return-Math.atan2(c,p)+.5*Math.PI},e.prototype.rect=function(e,t,n,o){return this.ctx.rect(e,t,n,o),this},e.prototype.textAlign=function(e){switch(e){case h.TextAlign.End:this.ctx.textAlign="end";break;case h.TextAlign.Left:this.ctx.textAlign="left";break;case h.TextAlign.Right:this.ctx.textAlign="right";break;case h.TextAlign.Center:this.ctx.textAlign="center";break;default:this.ctx.textAlign="start"}return this},e.prototype.textBaseline=function(e){switch(e){case h.TextBaseline.Bottom:this.ctx.textBaseline="bottom";break;case h.TextBaseline.Hanging:this.ctx.textBaseline="hanging";break;case h.TextBaseline.Ideographic:this.ctx.textBaseline="ideographic";break;case h.TextBaseline.Middle:this.ctx.textBaseline="middle";break;case h.TextBaseline.Top:this.ctx.textBaseline="top";break;default:this.ctx.textBaseline="alphabetic"}return this},e.prototype.fillText=function(e,t,n,o,i,s,r){return this.ctx.font=o,this.textAlign(i),this.textBaseline(s),this.ctx.fillText(e,t,n,r),this},e.prototype.strokeText=function(e,t,n,o,i,s,r){return this.ctx.font=o,this.textAlign(i),this.textBaseline(s),this.ctx.strokeText(e,t,n,r),this},e.prototype.splitText=function(e,t){e<50&&(e=50);for(var n=t.trim().split(" "),o="",i=new Array,s=0;s<n.length;s++){var r=o+n[s]+" ";e<this.ctx.measureText(r).width&&0<s?(i.push(o.trim()),o=n[s]+" "):o=r}return i.push(o.trim()),i},e.prototype.drawText=function(e,t,n,o,i,s,r){for(var l=Math.ceil(i)+1,a=this.splitText(n,r),c=i+"px Roboto",p=e+n/2,d=t-(a.length-1)*l/2+o/2,u=0;u<a.length;u++)this.fillText(a[u],p,d,c,h.TextAlign.Center,h.TextBaseline.Middle),d+=l;return this},e.prototype.drawTextBottom=function(e,t,n,o,i,s,r){for(var l=Math.ceil(i)+1,a=this.splitText(n,r),c=i+"px Roboto",p=e+n/2,d=t+o-(a.length-1)*l,u=0;u<a.length;u++)this.fillText(a[u],p,d,c,h.TextAlign.Center,h.TextBaseline.Bottom),d+=l;return this},e.prototype.textWidth=function(e,t){return this.ctx.font=t,this.ctx.measureText(e).width},e.prototype.clip=function(){return this.ctx.clip(),this},e.prototype.getImageData=function(e,t,n,o){return this.ctx.getImageData(e,t,n,o)},e}(),e("Canvas",o)}}}),System.register("grid",["app"],function(e,t){"use strict";var s,n;t&&t.id;return{setters:[function(e){s=e}],execute:function(){n=function(){function e(){}return e.prototype.drawGridLineV=function(e,t,n){var o=Math.floor(-e.offsetHeight)+.5,i=Math.floor(e.offsetHeight)+.5;n=Math.floor(n)+.5,t.beginPath().moveTo(n,o).lineTo(n,i).stroke()},e.prototype.drawGridLineH=function(e,t,n){var o=Math.floor(-e.offsetWidth)+.5,i=Math.floor(e.offsetWidth)+.5;n=Math.floor(n)+.5,t.beginPath().moveTo(o,n).lineTo(i,n).stroke()},e.prototype.draw=function(e,t){var n=s.App.map.settings.grid;if(n.visible){t.save().strokeStyle(n.color).lineWidth(n.lineWidth);for(var o=e.offsetWidth/2+s.App.centerX;0<o;)this.drawGridLineV(e,t,o),o-=n.size*s.App.zoom;for(o=e.offsetWidth/2+s.App.centerX+n.size*s.App.zoom;o<e.offsetWidth;)this.drawGridLineV(e,t,o),o+=n.size*s.App.zoom;for(var i=e.offsetHeight/2+s.App.centerY;0<i;)this.drawGridLineH(e,t,i),i-=n.size*s.App.zoom;for(i=e.offsetHeight/2+s.App.centerY+n.size*s.App.zoom;i<e.offsetHeight;)this.drawGridLineH(e,t,i),i+=n.size*s.App.zoom;n.origin&&(o=Math.floor(e.offsetWidth/2)+s.App.centerX,i=Math.floor(e.offsetHeight/2)+s.App.centerY,t.beginPath().lineWidth(n.originWidth).moveTo(o,i-n.size*s.App.zoom).lineTo(o,i+n.size*s.App.zoom).moveTo(o-n.size*s.App.zoom,i).lineTo(o+n.size*s.App.zoom,i).stroke()),t.restore()}},e.snap=function(e){var t=s.App.map.settings.grid;return t.snap?Math.floor(e/t.size)*t.size:e},e}(),e("Grid",n)}}}),System.register("util/rect",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(e,t,n,o){this.x=Math.min(e,n),this.y=Math.min(t,o),this.width=Math.abs(n-e),this.height=Math.abs(o-t)}return e.prototype.contains=function(e,t){return e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height},e}(),e("Rect",n)}}}),System.register("util/util",["util/rect"],function(o,e){"use strict";e&&e.id;return{setters:[function(e){!function(e){var t={};for(var n in e)"default"!==n&&(t[n]=e[n]);o(t)}(e)}],execute:function(){}}}),System.register("views/boxView",["views/view","util/util","enums/enums"],function(e,t){"use strict";var n,s,c,o;t&&t.id;return{setters:[function(e){n=e},function(e){s=e},function(e){c=e}],execute:function(){o=function(n){function e(e){var t=n.call(this)||this;return t.box=e,t.oldX=t.oldY=0,t.oldWidth=t.oldHeight=0,t}return __extends(e,n),e.prototype.getModel=function(){return this.box},e.prototype.makeShape=function(e,t){var n=t?c.Values.DIMEN_ROOM_MARGIN:0;switch(this.box.shape){case c.RoomShape.Ellipse:e.ellipse(-n,-n,this.box.width+2*n,this.box.height+2*n);break;case c.RoomShape.Octagon:e.octagon(-n,-n,this.box.width+2*n,this.box.height+2*n);break;default:e.roundedRect(-n,-n,this.box.width+2*n,this.box.height+2*n,this.box.rounding)}},e.prototype.drawResizeHandles=function(e,t,n,o,i){if(e.save().lineWidth(1),this.selected&&1==o){e.fillStyle(c.Values.COLOR_RESIZE).strokeStyle(c.Values.COLOR_LINE);for(var s=0;s<16;s++)if(c.Direction.isCardinal(s)){var r=this.box.directionToPos(s,!1),l=r.x,a=r.y;t>=l-c.Values.DIMEN_RESIZE_HANDLE&&t<=l+c.Values.DIMEN_RESIZE_HANDLE&&n>=a-c.Values.DIMEN_RESIZE_HANDLE&&n<=a+c.Values.DIMEN_RESIZE_HANDLE?e.fillStyle(c.Values.COLOR_RESIZE_HIGHLIGHT):e.fillStyle(c.Values.COLOR_RESIZE),e.beginPath().moveTo(l-c.Values.DIMEN_RESIZE_HANDLE,a-c.Values.DIMEN_RESIZE_HANDLE).fillRect(l-c.Values.DIMEN_RESIZE_HANDLE,a-c.Values.DIMEN_RESIZE_HANDLE,2*c.Values.DIMEN_RESIZE_HANDLE,2*c.Values.DIMEN_RESIZE_HANDLE).strokeRect(l-c.Values.DIMEN_RESIZE_HANDLE,a-c.Values.DIMEN_RESIZE_HANDLE,2*c.Values.DIMEN_RESIZE_HANDLE,2*c.Values.DIMEN_RESIZE_HANDLE)}}e.restore()},e.prototype.drawConnectorHandles=function(e,t,n,o,i){if(i&&0==o){e.save().lineWidth(1).strokeStyle(c.Values.COLOR_LINE);for(var s=0;s<16;s++){var r=this.box.directionToPos(s,!1),l=r.x,a=r.y;t>=l-c.Values.DIMEN_CONNECTOR_HANDLE&&t<=l+c.Values.DIMEN_CONNECTOR_HANDLE&&n>=a-c.Values.DIMEN_CONNECTOR_HANDLE&&n<=a+c.Values.DIMEN_CONNECTOR_HANDLE?e.fillStyle(c.Values.COLOR_CONNECTOR_HIGHLIGHT):e.fillStyle(c.Values.COLOR_CONNECTOR),e.beginPath().moveTo(l+c.Values.DIMEN_CONNECTOR_HANDLE,a).arc(l,a,c.Values.DIMEN_CONNECTOR_HANDLE,0,2*Math.PI,!0).fill().stroke()}e.restore()}},e.prototype.isResizeHandle=function(e,t){for(var n=0;n<16;n++)if(c.Direction.isCardinal(n)){var o=this.box.directionToPos(n,!1),i=o.x,s=o.y;if(e>=i-c.Values.DIMEN_RESIZE_HANDLE&&e<=i+c.Values.DIMEN_RESIZE_HANDLE&&t>=s-c.Values.DIMEN_RESIZE_HANDLE&&t<=s+c.Values.DIMEN_RESIZE_HANDLE)return n}},e.prototype.isConnectorHandle=function(e,t){for(var n=0;n<16;n++){var o=this.box.directionToPos(n,!1),i=o.x,s=o.y;if(e>=i-c.Values.DIMEN_CONNECTOR_HANDLE&&e<=i+c.Values.DIMEN_CONNECTOR_HANDLE&&t>=s-c.Values.DIMEN_CONNECTOR_HANDLE&&t<=s+c.Values.DIMEN_CONNECTOR_HANDLE)return n}},e.prototype.isIn=function(e,t,n,o){var i=new s.Rect(e,t,n,o);return!!i.contains(this.box.x,this.box.y)||(!!i.contains(this.box.x+this.box.width,this.box.y)||(!!i.contains(this.box.x,this.box.y+this.box.height)||!!i.contains(this.box.x+this.box.width,this.box.y+this.box.height)))},e.prototype.resize=function(e,t,n){var o=0,i=0;e!=c.Direction.N&&e!=c.Direction.NE&&e!=c.Direction.NW||((i=this.oldY+this.oldHeight-n)<c.Values.DIMEN_ROOM_MIN_HEIGHT&&(n-=c.Values.DIMEN_ROOM_MIN_HEIGHT-i,i=c.Values.DIMEN_ROOM_MIN_HEIGHT),this.box.y=n,this.box.height=i),e!=c.Direction.W&&e!=c.Direction.NW&&e!=c.Direction.SW||((o=this.oldX+this.oldWidth-t)<c.Values.DIMEN_ROOM_MIN_WIDTH&&(t-=c.Values.DIMEN_ROOM_MIN_WIDTH-o,o=c.Values.DIMEN_ROOM_MIN_WIDTH),this.box.x=t,this.box.width=o),e!=c.Direction.E&&e!=c.Direction.NE&&e!=c.Direction.SE||((o=t-this.oldX)<c.Values.DIMEN_ROOM_MIN_WIDTH&&(t-=c.Values.DIMEN_ROOM_MIN_WIDTH-o,o=c.Values.DIMEN_ROOM_MIN_WIDTH),this.box.width=o),e!=c.Direction.S&&e!=c.Direction.SE&&e!=c.Direction.SW||((i=n-this.oldY)<c.Values.DIMEN_ROOM_MIN_HEIGHT&&(n-=c.Values.DIMEN_ROOM_MIN_HEIGHT-i,i=c.Values.DIMEN_ROOM_MIN_HEIGHT),this.box.height=i)},e.prototype.save=function(){this.oldX=this.box.x,this.oldY=this.box.y,this.oldWidth=this.box.width,this.oldHeight=this.box.height},e}(n.View),e("BoxView",o)}}}),System.register("views/roomView",["views/boxView","enums/enums"],function(e,t){"use strict";var n,r,o;t&&t.id;return{setters:[function(e){n=e},function(e){r=e}],execute:function(){o=function(n){function e(e){var t=n.call(this,e)||this;return t.room=e,t}return __extends(e,n),e.prototype.getModel=function(){return this.room},e.prototype.draw=function(e,t,n,o,i){if(e.save().translate(this.room.x,this.room.y),this.makeShape(e,!0),e.fillStyle(r.Values.COLOR_TRANSPARENT).fill(),this.selected&&e.fillStyle(r.Values.COLOR_SELECTED_GLOW).fill(),this.room.isStartRoom()&&e.fillStyle(r.Values.COLOR_STARTROOM).fill(),this.room.endroom&&e.fillStyle(r.Values.COLOR_ENDROOM).fill(),this.makeShape(e,!1),e.fillStyle(this.room.fillColor).fill(),e.clip(),this.makeShape(e,!1),this.room.dark){var s=this.room.map.settings.room.darknessSize;e.fillStyle(this.room.map.settings.room.darkColor).beginPath().moveTo(this.room.width,0).lineTo(this.room.width-this.room.height*s/100,0).lineTo(this.room.width,this.room.height*s/100).fill()}this.room.lineStyle!=r.LineStyle.None&&(this.makeShape(e,!1),e.strokeStyle(this.room.borderColor).lineWidth(this.room.lineWidth).lineDash(this.room.lineStyle).stroke()),e.fillStyle(this.room.nameColor).drawText(0,0,this.room.width,this.room.height,14.4,"Roboto",this.room.name),e.fillStyle(this.room.subtitle).drawTextBottom(0,0,this.room.width,this.room.height-5,11.8,"Roboto",this.room.subtitle),e.restore()},e.prototype.drawHandles=function(e,t,n,o,i){this.drawResizeHandles(e,t,n,o,i),this.drawConnectorHandles(e,t,n,o,i)},e}(n.BoxView),e("RoomView",o)}}}),System.register("views/connectorView",["app","views/view","util/util","enums/enums","drawing/IScreen"],function(e,t){"use strict";var B,n,l,z,X,o;t&&t.id;return{setters:[function(e){B=e},function(e){n=e},function(e){l=e},function(e){z=e},function(e){X=e}],execute:function(){o=function(n){function e(e){var t=n.call(this)||this;return t.connector=e,t}return __extends(e,n),e.prototype.getModel=function(){return this.connector},e.prototype.drawConnectorHandle=function(e,t,n,o,i){o>=t-z.Values.DIMEN_CONNECTOR_HANDLE&&o<=t+z.Values.DIMEN_CONNECTOR_HANDLE&&i>=n-z.Values.DIMEN_CONNECTOR_HANDLE&&i<=n+z.Values.DIMEN_CONNECTOR_HANDLE?e.fillStyle(z.Values.COLOR_CONNECTOR_HIGHLIGHT):e.fillStyle(z.Values.COLOR_CONNECTOR),e.beginPath().moveTo(t+z.Values.DIMEN_CONNECTOR_HANDLE,n).arc(t,n,z.Values.DIMEN_CONNECTOR_HANDLE,0,2*Math.PI,!0).fill().stroke()},e.prototype.dockToPoints=function(e,t){var n=e.directionToPos(t,!1),o=n.x,i=n.y,s=e.directionToPos(t,!0),r=s.x,l=s.y;return{x:o,y:i,dx:r+z.Direction.toCardinalVector(t).x*B.App.map.settings.connector.stalk,dy:l+z.Direction.toCardinalVector(t).y*B.App.map.settings.connector.stalk}},e.prototype.drawArrow=function(e,t,n,o){var i=B.App.map.settings.connector.arrowSize;e.save(),e.translate(t,n),e.rotate(o),e.translate(-t,-n),e.beginPath(),e.moveTo(t-i,n-i),e.lineTo(t-i,n+i),e.lineTo(t+i,n),e.closePath(),e.fill(),e.restore()},e.prototype.draw=function(e,t,n,o,i){var s=this.connector.startX,r=this.connector.startY,l=this.connector.endX,a=this.connector.endY,c=this.connector.startX,p=this.connector.startY,d=this.connector.endX,u=this.connector.endY;if(e.save().beginPath(),this.connector.dockStart||this.connector.dockEnd)if(this.connector.dockStart&&this.connector.dockEnd){var h=this.dockToPoints(this.connector.dockStart,this.connector.startDir),f=(s=h.x,r=h.y,c=h.dx,p=h.dy,this.dockToPoints(this.connector.dockEnd,this.connector.endDir));l=f.x,a=f.y,d=f.dx,u=f.dy}else if(this.connector.dockStart&&!this.connector.dockEnd){var m=this.dockToPoints(this.connector.dockStart,this.connector.startDir);s=m.x,r=m.y,c=m.dx,p=m.dy}else{var v=this.dockToPoints(this.connector.dockEnd,this.connector.endDir);l=v.x,a=v.y,d=v.dx,u=v.dy}else;if(x=c+.1*(d-c),E=p+.1*(u-p),L=c+.9*(d-c),D=p+.9*(u-p),C=M=Math.atan2(u-p,d-c),I=c+.5*(d-c),P=p+.5*(u-p),this.connector.dockStart||this.connector.dockEnd)if(this.connector.dockStart&&this.connector.dockEnd){if(e.moveTo(s,r),e.lineTo(c,p),this.connector.isCurve){var g=Math.sqrt((d-c)*(d-c)+(u-p)*(u-p))*B.App.map.settings.connector.curveStrength,y=c+z.Direction.toCardinalVector(this.connector.startDir).x*g,b=p+z.Direction.toCardinalVector(this.connector.startDir).y*g,k=d+z.Direction.toCardinalVector(this.connector.endDir).x*g,S=u+z.Direction.toCardinalVector(this.connector.endDir).y*g;e.bezierCurveTo(y,b,k,S,d,u);var w=e.getBezierXY(.1,c,p,y,b,k,S,d,u),x=w.x,E=w.y,C=e.getBezierAngle(.1,c,p,y,b,k,S,d,u),A=e.getBezierXY(.9,c,p,y,b,k,S,d,u),L=A.x,D=A.y,M=e.getBezierAngle(.9,c,p,y,b,k,S,d,u),R=e.getBezierXY(.5,c,p,y,b,k,S,d,u),I=R.x,P=R.y}else e.lineTo(d,u);e.lineTo(l,a)}else if(this.connector.dockStart&&!this.connector.dockEnd)if(e.moveTo(s,r),e.lineTo(c,p),this.connector.isCurve){g=Math.sqrt((d-c)*(d-c)+(u-p)*(u-p))*B.App.map.settings.connector.curveStrength,y=c+z.Direction.toCardinalVector(this.connector.startDir).x*g,b=p+z.Direction.toCardinalVector(this.connector.startDir).y*g;e.quadraticCurveTo(y,b,d,u);for(var N=0;N<1;N+=.1){var T=e.getQuadraticXY(.1,c,p,y,b,d,u),j=(x=T.x,E=T.y,C=e.getQuadraticAngle(.1,c,p,y,b,d,u),e.getQuadraticXY(.9,c,p,y,b,d,u)),O=(L=j.x,D=j.y,M=e.getQuadraticAngle(.9,c,p,y,b,d,u),e.getQuadraticXY(.5,c,p,y,b,d,u));I=O.x,P=O.y}}else e.lineTo(d,u);else{if(e.moveTo(c,p),this.connector.isCurve){g=Math.sqrt((d-c)*(d-c)+(u-p)*(u-p))*B.App.map.settings.connector.curveStrength,y=d+z.Direction.toCardinalVector(this.connector.endDir).x*g,b=u+z.Direction.toCardinalVector(this.connector.endDir).y*g;e.quadraticCurveTo(y,b,d,u);var _=e.getQuadraticXY(.1,c,p,y,b,d,u),H=(x=_.x,E=_.y,C=e.getQuadraticAngle(.1,c,p,y,b,d,u),e.getQuadraticXY(.9,c,p,y,b,d,u)),W=(L=H.x,D=H.y,M=e.getQuadraticAngle(.9,c,p,y,b,d,u),e.getQuadraticXY(.5,c,p,y,b,d,u));I=W.x,P=W.y}else e.lineTo(d,u);e.lineTo(l,a)}else e.moveTo(c,p),e.lineTo(d,u);if(e.lineWidth(20).lineCap(X.CapStyle.Round).lineJoin(X.JoinStyle.Round).strokeStyle(z.Values.COLOR_TRANSPARENT).stroke(),e.lineWidth(this.connector.lineWidth).strokeStyle(this.selected?z.Values.COLOR_SELECTED:i?z.Values.COLOR_HOVER:this.connector.color).lineDash(this.connector.lineStyle).stroke(),this.connector.oneWay&&(e.fillStyle(this.selected?z.Values.COLOR_SELECTED:i?z.Values.COLOR_HOVER:this.connector.color),this.drawArrow(e,x,E,C),this.drawArrow(e,L,D,M)),this.connector.name){var V=e.textWidth(this.connector.name,"12.8px Roboto");e.lineWidth(1).lineDash(z.LineStyle.Solid).strokeStyle("#000").fillStyle("#fff").roundedRect(I-V/2-5,P-11,V+10,20,3).fill().stroke().fillStyle("#333").fillText(this.connector.name,I,P,"12.8px Roboto",X.TextAlign.Center,X.TextBaseline.Middle)}e.beginPath().fillStyle("#333").fillText(this.connector.startLabel?this.connector.startLabel:z.ConnectorType.toString(this.connector.startType),x+Math.cos(C-Math.PI/2)*B.App.map.settings.connector.labelDistance,E+Math.sin(C-Math.PI/2)*B.App.map.settings.connector.labelDistance,"10.8px Roboto",X.TextAlign.Center,X.TextBaseline.Middle).fillText(this.connector.endLabel?this.connector.endLabel:z.ConnectorType.toString(this.connector.endType),L+Math.cos(M+Math.PI/2)*B.App.map.settings.connector.labelDistance,D+Math.sin(M+Math.PI/2)*B.App.map.settings.connector.labelDistance,"10.8px Roboto",X.TextAlign.Center,X.TextBaseline.Middle),e.restore()},e.prototype.drawHandles=function(e,t,n,o,i){if(this.selected&&1==o){e.save().lineWidth(1).strokeStyle(z.Values.COLOR_LINE);var s=this.getStartHandleLocation(),r=s.x,l=s.y;this.drawConnectorHandle(e,r,l,t,n);var a=this.getEndHandleLocation();r=a.x,l=a.y;this.drawConnectorHandle(e,r,l,t,n),e.restore()}},e.prototype.isIn=function(e,t,n,o){var i=new l.Rect(e,t,n,o),s=this.getStartHandleLocation();e=s.x,t=s.y;if(i.contains(e,t))return!0;var r=this.getEndHandleLocation();e=r.x,t=r.y;return!!i.contains(e,t)},e.prototype.getStartHandleLocation=function(){if(this.connector.dockStart)var e=this.connector.dockStart.directionToPos(this.connector.startDir,!1),t=e.x,n=e.y;else t=this.connector.startX,n=this.connector.startY;return{x:t,y:n}},e.prototype.getEndHandleLocation=function(){if(this.connector.dockEnd)var e=this.connector.dockEnd.directionToPos(this.connector.endDir,!1),t=e.x,n=e.y;else t=this.connector.endX,n=this.connector.endY;return{x:t,y:n}},e.prototype.isConnectorHandle=function(e,t){var n=this.getStartHandleLocation(),o=n.x,i=n.y;if(e>=o-z.Values.DIMEN_CONNECTOR_HANDLE&&e<=o+z.Values.DIMEN_CONNECTOR_HANDLE&&t>=i-z.Values.DIMEN_CONNECTOR_HANDLE&&t<=i+z.Values.DIMEN_CONNECTOR_HANDLE)return z.ConnectorHandle.Start;var s=this.getEndHandleLocation();o=s.x,i=s.y;return e>=o-z.Values.DIMEN_CONNECTOR_HANDLE&&e<=o+z.Values.DIMEN_CONNECTOR_HANDLE&&t>=i-z.Values.DIMEN_CONNECTOR_HANDLE&&t<=i+z.Values.DIMEN_CONNECTOR_HANDLE?z.ConnectorHandle.End:void 0},e}(n.View),e("ConnectorView",o)}}}),System.register("models/note",["models/box","models/mapSettings"],function(e,t){"use strict";var n,o,i;t&&t.id;return{setters:[function(e){n=e},function(e){o=e}],execute:function(){i=function(n){function e(e){var t=n.call(this,e)||this;return t.type="Note",t.text="Note",t.width=e.note.width,t.height=e.note.height,t}return __extends(e,n),Object.defineProperty(e.prototype,"textColor",{get:function(){return this._textColor?this._textColor:this.map.settings.note.textColor},set:function(e){this._textColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillColor",{get:function(){return this._fillColor?this._fillColor:this.map.settings.note.fillColor},set:function(e){this._fillColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borderColor",{get:function(){return this._borderColor?this._borderColor:this.map.settings.note.borderColor},set:function(e){this._borderColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rounding",{get:function(){return null!=this._rounding?this._rounding:this.map.settings.note.rounding},set:function(e){this._rounding=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){return null!=this._shape?this._shape:this.map.settings.note.shape},set:function(e){this._shape=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return null!=this._lineStyle?this._lineStyle:this.map.settings.note.lineStyle},set:function(e){this._lineStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return null!=this._lineWidth?this._lineWidth:this.map.settings.note.lineWidth},set:function(e){this._lineWidth=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return this.cloneToTarget(new e(new o.MapSettings))},e}(n.Box),e("Note",i)}}}),System.register("views/noteView",["views/boxView","enums/enums"],function(e,t){"use strict";var n,s,o;t&&t.id;return{setters:[function(e){n=e},function(e){s=e}],execute:function(){o=function(n){function e(e){var t=n.call(this,e)||this;return t.note=e,t}return __extends(e,n),e.prototype.getModel=function(){return this.note},e.prototype.draw=function(e,t,n,o,i){e.save().translate(this.note.x,this.note.y),this.makeShape(e,!0),e.fillStyle(s.Values.COLOR_TRANSPARENT).fill(),this.selected&&e.fillStyle(s.Values.COLOR_SELECTED_GLOW).fill(),this.makeShape(e,!1),e.fillStyle(this.note.fillColor).fill(),e.clip(),this.makeShape(e,!1),e.lineWidth(this.note.lineWidth/2).strokeStyle(this.note.borderColor).beginPath().moveTo(this.note.width-.6*this.note.height,0).lineTo(this.note.width,.6*this.note.height).stroke(),this.note.lineStyle!=s.LineStyle.None&&(this.makeShape(e,!1),e.strokeStyle(this.note.borderColor).lineWidth(this.note.lineWidth).lineDash(this.note.lineStyle).stroke()),e.fillStyle(this.note.textColor).drawText(0,0,this.note.width,this.note.height,14.4,"Roboto",this.note.text),e.restore()},e.prototype.drawHandles=function(e,t,n,o,i){this.drawResizeHandles(e,t,n,o,i)},e}(n.BoxView),e("NoteView",o)}}}),System.register("models/block",["models/box","models/mapSettings"],function(e,t){"use strict";var n,o,i;t&&t.id;return{setters:[function(e){n=e},function(e){o=e}],execute:function(){i=function(n){function e(e){var t=n.call(this,e)||this;return t.type="Block",t.width=e.block.width,t.height=e.block.height,t}return __extends(e,n),Object.defineProperty(e.prototype,"fillColor",{get:function(){return this._fillColor?this._fillColor:this.map.settings.block.fillColor},set:function(e){this._fillColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borderColor",{get:function(){return this._borderColor?this._borderColor:this.map.settings.block.borderColor},set:function(e){this._borderColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rounding",{get:function(){return null!=this._rounding?this._rounding:this.map.settings.block.rounding},set:function(e){this._rounding=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){return null!=this._shape?this._shape:this.map.settings.block.shape},set:function(e){this._shape=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return null!=this._lineStyle?this._lineStyle:this.map.settings.block.lineStyle},set:function(e){this._lineStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return null!=this._lineWidth?this._lineWidth:this.map.settings.block.lineWidth},set:function(e){this._lineWidth=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return this.cloneToTarget(new e(new o.MapSettings))},e}(n.Box),e("Block",i)}}}),System.register("views/blockView",["views/boxView","enums/enums"],function(e,t){"use strict";var n,s,o;t&&t.id;return{setters:[function(e){n=e},function(e){s=e}],execute:function(){o=function(n){function e(e){var t=n.call(this,e)||this;return t.block=e,t}return __extends(e,n),e.prototype.getModel=function(){return this.block},e.prototype.draw=function(e,t,n,o,i){e.save().translate(this.block.x,this.block.y),this.makeShape(e,!0),e.fillStyle(s.Values.COLOR_TRANSPARENT).fill(),this.selected&&e.fillStyle(s.Values.COLOR_SELECTED_GLOW).fill(),this.makeShape(e,!1),e.fillStyle(this.block.fillColor).fill(),this.block.lineStyle!=s.LineStyle.None&&(this.makeShape(e,!1),e.strokeStyle(this.block.borderColor).lineWidth(this.block.lineWidth).lineDash(this.block.lineStyle).stroke()),e.restore()},e.prototype.drawHandles=function(e,t,n,o,i){this.drawResizeHandles(e,t,n,o,i)},e}(n.BoxView),e("BlockView",o)}}}),System.register("views/viewFactory",["models/room","models/note","models/connector","views/roomView","views/noteView","views/connectorView","models/block","views/blockView"],function(e,t){"use strict";var n,o,i,s,r,l,a,c,p;t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e},function(e){s=e},function(e){r=e},function(e){l=e},function(e){a=e},function(e){c=e}],execute:function(){p=function(){function e(){}return e.create=function(e){if(e instanceof n.Room)return new s.RoomView(e);if(e instanceof o.Note)return new r.NoteView(e);if(e instanceof i.Connector)return new l.ConnectorView(e);if(e instanceof a.Block)return new c.BlockView(e);throw"No view registered for model."},e}(),e("ViewFactory",p)}}}),System.register("editor",["app","dispatcher","enums/enums","grid","models/room","models/connector","views/roomView","views/connectorView","models/note","views/noteView","views/boxView","views/viewFactory","drawing/canvas","models/block","views/blockView","enums/connectorType"],function(e,t){"use strict";var p,c,d,u,h,f,m,v,n,o,g,y,i,s,r,l,a;t&&t.id;return{setters:[function(e){p=e},function(e){c=e},function(e){d=e},function(e){u=e},function(e){h=e},function(e){f=e},function(e){m=e},function(e){v=e},function(e){n=e},function(e){o=e},function(e){g=e},function(e){y=e},function(e){i=e},function(e){s=e},function(e){r=e},function(e){l=e}],execute:function(){a=function(){function e(){var t=this;this.grid=new u.Grid,this.hover=null,this.copy=new Array,this.mouseX=-100,this.mouseY=-100,this.dragOriginX=0,this.dragOriginY=0,this.render=function(){t.canvas.save(),t.clear(),t.grid.draw(t.htmlCanvas,t.canvas),document.getElementById("debug-zoom").textContent=Math.floor(100*p.App.zoom)+"%",t.canvas.translate(Math.floor(t.htmlCanvas.offsetWidth/2)+p.App.centerX,Math.floor(t.htmlCanvas.offsetHeight/2)+p.App.centerY),t.canvas.scale(p.App.zoom,p.App.zoom),t.views.forEach(function(e){e instanceof r.BlockView&&e.draw(t.canvas,t.mouseX,t.mouseY,p.App.mouseMode==d.MouseMode.Connect?0:p.App.selection.size(),t.hover==e&&p.App.mouseMode!=d.MouseMode.Select)}),t.views.forEach(function(e){e instanceof v.ConnectorView&&e.draw(t.canvas,t.mouseX,t.mouseY,p.App.mouseMode==d.MouseMode.Connect?0:p.App.selection.size(),t.hover==e&&p.App.mouseMode!=d.MouseMode.Select)}),t.views.forEach(function(e){(e instanceof m.RoomView||e instanceof o.NoteView)&&e.draw(t.canvas,t.mouseX,t.mouseY,p.App.mouseMode==d.MouseMode.Connect?0:p.App.selection.size(),t.hover==e&&p.App.mouseMode!=d.MouseMode.Select)}),t.views.forEach(function(e){e.drawHandles(t.canvas,t.mouseX,t.mouseY,p.App.mouseMode==d.MouseMode.Connect?0:p.App.selection.size(),t.hover==e&&p.App.mouseMode!=d.MouseMode.Select)}),p.App.mouseMode==d.MouseMode.Select&&t.drawSelectionArea(),t.canvas.restore(),window.requestAnimationFrame(t.render)},c.Dispatcher.subscribe(this),this.htmlCanvas=document.getElementById("canvas"),this.canvas=new i.Canvas(this.htmlCanvas.getContext("2d")),this.hitTestHtmlCanvas=document.getElementById("hittest"),this.hitTestCanvas=new i.Canvas(this.hitTestHtmlCanvas.getContext("2d")),this.views=new Array,this.makeTestMap(),window.addEventListener("resize",function(){t.resize()}),this.htmlCanvas.addEventListener("mousedown",function(e){t.canvasMouseDown(e)}),this.htmlCanvas.addEventListener("mouseup",function(e){t.canvasMouseUp(e)}),this.htmlCanvas.addEventListener("mousemove",function(e){t.canvasMouseMove(e)}),this.htmlCanvas.addEventListener("wheel",function(e){t.canvasMouseWheel(e)}),document.getElementById("control-center").addEventListener("click",function(){t.cmdCenterView()}),document.getElementById("control-zoomin").addEventListener("click",function(){t.cmdZoomIn()}),document.getElementById("control-zoomout").addEventListener("click",function(){t.cmdZoomOut()}),this.resize(),window.requestAnimationFrame(this.render),document.getElementById("canvas").addEventListener("keyup",function(e){t.keyUp(e)})}return e.prototype.keyUp=function(e){if(console.log("Key up: ",e),!e.ctrlKey&&!e.shiftKey)switch(e.key){case"a":this.cmdToggleOneWay();break;case"v":this.cmdReverseConnector();break;case"k":this.cmdToggleDarkness();break;case"r":this.cmdAddRoom();break;case"n":this.cmdAddNote();break;case"b":this.cmdAddBlock();break;case"Escape":p.App.selection.unselectAll();break;case"Delete":this.cmdDelete();break;case"Insert":this.cmdCenterView();break;case"+":this.cmdZoomIn();break;case"-":this.cmdZoomOut();break;case"0":this.cmdZoomNormal();break;case"Enter":case"F2":this.cmdShowPanel();break;case"ArrowRight":this.moveCenter(1,0);break;case"ArrowLeft":this.moveCenter(-1,0);break;case"ArrowUp":this.moveCenter(0,-1);break;case"ArrowDown":this.moveCenter(0,1);break;case"PageUp":this.moveCenter(1,-1);break;case"PageDown":this.moveCenter(1,1);break;case"End":this.moveCenter(-1,1);break;case"Home":this.moveCenter(-1,-1)}if(e.ctrlKey)switch(e.key){case"a":this.cmdSelectAll();break;case"c":this.cmdCopySelection();break;case"v":this.cmdPaste();break;case"z":p.App.undo()}if(e.shiftKey)switch(e.key){case"ArrowRight":this.cmdNewRoomInDir(d.Direction.E);break;case"ArrowLeft":this.cmdNewRoomInDir(d.Direction.W);break;case"ArrowUp":this.cmdNewRoomInDir(d.Direction.N);break;case"ArrowDown":this.cmdNewRoomInDir(d.Direction.S);break;case"PageUp":this.cmdNewRoomInDir(d.Direction.NE);break;case"PageDown":this.cmdNewRoomInDir(d.Direction.SE);break;case"End":this.cmdNewRoomInDir(d.Direction.SW);break;case"Home":this.cmdNewRoomInDir(d.Direction.NW)}e.preventDefault()},e.prototype.notify=function(e,t){var n=this;if(e==d.AppEvent.Delete){p.App.selection.clear();for(var o=0;o<this.views.length;o++)if(this.views[o].getModel()==t){this.views.splice(o,1);break}}e==d.AppEvent.Load&&(p.App.selection.unselectAll(),this.views.length=0,p.App.map.elements.forEach(function(e){n.views.push(y.ViewFactory.create(e))}),this.cmdCenterView())},e.prototype.makeTestMap=function(){var e=new h.Room(p.App.map.settings);p.App.map.add(e),e.name="hello",e.x=0,e.y=0,this.views.push(y.ViewFactory.create(e));var t=new f.Connector(p.App.map.settings);p.App.map.add(t),t.name="abc",t.dockStart=e,t.startDir=d.Direction.E,t.isCurve=!0,t.oneWay=!0,t.startType=l.ConnectorType.In,t.endType=l.ConnectorType.Out,this.views.push(y.ViewFactory.create(t));var n=new h.Room(p.App.map.settings);p.App.map.add(n),n.name="world",n.x=320,n.y=320,this.views.push(y.ViewFactory.create(n)),t.dockEnd=n,t.endDir=d.Direction.W},e.prototype.clear=function(){this.canvas.clearRect(0,0,this.htmlCanvas.offsetWidth,this.htmlCanvas.offsetHeight)},e.prototype.drawSelectionArea=function(){var e=Math.min(this.mouseX,this.selectPosX),t=Math.min(this.mouseY,this.selectPosY),n=Math.abs(this.mouseX-this.selectPosX),o=Math.abs(this.mouseY-this.selectPosY);this.canvas.strokeStyle(d.Values.COLOR_SELECTION_LINE).fillStyle(d.Values.COLOR_SELECTION_AREA).fillRect(e,t,n,o).strokeRect(e,t,n,o)},e.prototype.hitTest=function(e,t,n){return this.hitTestCanvas.save().clearRect(0,0,1,1).scale(p.App.zoom,p.App.zoom).translate(-e,-t),n.draw(this.hitTestCanvas,0,0,p.App.selection.size(),this.hover==n),this.hitTestCanvas.restore(),0<this.hitTestCanvas.getImageData(0,0,1,1).data[3]},e.prototype.resize=function(){this.htmlCanvas.setAttribute("width",this.htmlCanvas.offsetWidth.toString()),this.htmlCanvas.setAttribute("height",this.htmlCanvas.offsetHeight.toString())},e.prototype.findObjCoordinates=function(e){var t=0,n=0;if(e.offsetParent)for(;t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;);return{x:t,y:n}},e.prototype.findMouseCoordinates=function(e){var t=this.findObjCoordinates(this.htmlCanvas),n=t.x,o=t.y;return{x:Math.floor((e.clientX-n-this.htmlCanvas.offsetWidth/2-p.App.centerX)/p.App.zoom),y:Math.floor((e.clientY-o-this.htmlCanvas.offsetHeight/2-p.App.centerY)/p.App.zoom)}},e.prototype.findViewByCoordinates=function(e,t){for(var n=0;n<this.views.length;n++)if(!(this.views[n]instanceof r.BlockView)&&this.hitTest(e,t,this.views[n]))return this.views[n];for(n=0;n<this.views.length;n++)if(this.views[n]instanceof r.BlockView&&this.hitTest(e,t,this.views[n]))return this.views[n]},e.prototype.canvasMouseDown=function(e){var t=this.findMouseCoordinates(e),n=t.x,o=t.y;if(p.App.mouseMode!=d.MouseMode.AddRoom)if(p.App.mouseMode!=d.MouseMode.AddNote)if(p.App.mouseMode!=d.MouseMode.AddBlock){if(2==e.which)return p.App.mouseMode=d.MouseMode.Scroll,this.scrollOffsetX=e.clientX,this.scrollOffsetY=e.clientY,this.scrollOriginX=p.App.centerX,this.scrollOriginY=p.App.centerY,void(this.htmlCanvas.style.cursor="move");var i=this.findViewByCoordinates(n,o);if(void 0===i)e.ctrlKey||p.App.selection.unselectAll(),p.App.mouseMode=d.MouseMode.Select,this.selectPosX=n,this.selectPosY=o;else if(p.App.selection.isSingle()&&p.App.selection.first()instanceof v.ConnectorView&&void 0!==p.App.selection.first().isConnectorHandle(n,o))p.App.pushUndo(),p.App.mouseMode=d.MouseMode.Connect,this.connectorHandle=p.App.selection.first().isConnectorHandle(n,o),this.htmlCanvas.style.cursor="crosshair";else if(i instanceof g.BoxView&&p.App.selection.isSingle()&&p.App.selection.first()==i&&void 0!==i.isResizeHandle(n,o))p.App.pushUndo(),p.App.mouseMode=d.MouseMode.Resize,this.roomHandle=i.isResizeHandle(n,o),i.save(),this.htmlCanvas.style.cursor=d.Direction.toCursor(this.roomHandle);else if(i instanceof m.RoomView&&p.App.selection.isEmpty()&&null!=i.isConnectorHandle(n,o)){p.App.pushUndo(),p.App.mouseMode=d.MouseMode.Connect;var s=i.isConnectorHandle(n,o),r=new f.Connector(p.App.map.settings);p.App.map.add(r),r.dockStart=i.room,r.startDir=s,r.endDir=s,r.endX=n,r.endY=o;var l=y.ViewFactory.create(r);this.views.push(l),p.App.selection.add([l]),this.connectorHandle=d.ConnectorHandle.End,this.htmlCanvas.style.cursor="crosshair"}else e.ctrlKey?i.isSelected()||p.App.selection.add([i]):i.isSelected()||p.App.selection.select(i),this.htmlCanvas.style.cursor="pointer",p.App.pushUndo(),p.App.mouseMode=d.MouseMode.Drag,this.dragOriginX=n,this.dragOriginY=o,p.App.selection.get().forEach(function(e){e instanceof g.BoxView&&e.save()})}else this.cmdAddBlock();else this.cmdAddNote();else this.cmdAddRoom()},e.prototype.canvasMouseMove=function(e){var t=this;p.App.mouseMode!=d.MouseMode.None&&c.Dispatcher.notify(d.AppEvent.MouseMove,null);var n=this.findMouseCoordinates(e),o=n.x,i=n.y;this.mouseX=o,this.mouseY=i;var s=this.findViewByCoordinates(o,i);switch(s!=this.hover&&(this.hover=s),p.App.mouseMode){case d.MouseMode.Scroll:p.App.centerX=this.scrollOriginX+(e.clientX-this.scrollOffsetX),p.App.centerY=this.scrollOriginY+(e.clientY-this.scrollOffsetY);break;case d.MouseMode.Drag:p.App.selection.get().forEach(function(e){e instanceof g.BoxView&&(e.getModel().x=u.Grid.snap(e.oldX-t.dragOriginX+o),e.getModel().y=u.Grid.snap(e.oldY-t.dragOriginY+i))});break;case d.MouseMode.Resize:var r=p.App.selection.first();r instanceof g.BoxView&&r.resize(this.roomHandle,u.Grid.snap(o),u.Grid.snap(i));break;case d.MouseMode.Connect:var l=p.App.selection.first();if(s instanceof m.RoomView){var a=s.isConnectorHandle(o,i);void 0!==a&&(this.connectorHandle==d.ConnectorHandle.Start?(l.connector.dockStart=s.room,l.connector.startDir=a):(l.connector.dockEnd=s.room,l.connector.endDir=a))}else this.connectorHandle==d.ConnectorHandle.Start?(l.connector.dockStart=null,l.connector.startX=u.Grid.snap(o),l.connector.startY=u.Grid.snap(i)):(l.connector.dockEnd=null,l.connector.endX=u.Grid.snap(o),l.connector.endY=u.Grid.snap(i))}},e.prototype.canvasMouseUp=function(e){switch(p.App.mouseMode){case d.MouseMode.Select:p.App.selection.unselectAll();for(var t=0;t<this.views.length;t++)this.views[t].isIn(this.mouseX,this.mouseY,this.selectPosX,this.selectPosY)&&p.App.selection.add([this.views[t]])}this.htmlCanvas.style.cursor="default",p.App.mouseMode=d.MouseMode.None},e.prototype.canvasMouseWheel=function(e){e.deltaY<0&&this.cmdZoomIn(),0<e.deltaY&&this.cmdZoomOut()},e.prototype.cmdSelectAll=function(){p.App.selection.unselectAll(),p.App.selection.add(this.views)},e.prototype.cmdShowPanel=function(){p.App.selection.isSingle()&&c.Dispatcher.notify(d.AppEvent.More,p.App.selection.first().getModel())},e.prototype.cmdReverseConnector=function(){if(p.App.selection.isSingle()&&p.App.selection.first()instanceof v.ConnectorView){var e=p.App.selection.first().getModel();e.isDoubleDocked()&&(p.App.pushUndo(),e.reverse())}},e.prototype.cmdToggleDarkness=function(){if(p.App.selection.isSingle()&&p.App.selection.first()instanceof m.RoomView){var e=p.App.selection.first().getModel();p.App.pushUndo(),e.dark=!e.dark}},e.prototype.cmdDelete=function(){if(!p.App.selection.isEmpty()){p.App.pushUndo();var t=new Array;p.App.selection.get().forEach(function(e){t.push(e)}),t.forEach(function(e){e.getModel().delete()})}},e.prototype.cmdToggleOneWay=function(){if(p.App.selection.isSingle()&&p.App.selection.first()instanceof v.ConnectorView){var e=p.App.selection.first().getModel();p.App.pushUndo(),e.oneWay=!e.oneWay}},e.prototype.cmdNewRoomInDir=function(e){if(p.App.selection.isSingle()&&p.App.selection.first()instanceof m.RoomView){var t=p.App.selection.first().getModel();if(!t.hasConnection(e)){p.App.pushUndo();var n=new h.Room(p.App.map.settings);p.App.map.add(n);var o=d.Direction.toVector(e),i=o.x,s=o.y;n.x=t.x+t.width/2+i*t.width+2*p.App.map.settings.grid.size*i-n.width/2,n.y=t.y+t.height/2+s*t.height+2*p.App.map.settings.grid.size*s-n.height/2;var r=y.ViewFactory.create(n);this.views.push(r);var l=new f.Connector(p.App.map.settings);p.App.map.add(l),l.dockStart=t,l.dockEnd=n,l.startDir=e,l.endDir=d.Direction.opposite(e),r=y.ViewFactory.create(l),this.views.push(r)}}},e.prototype.moveCenter=function(e,t){p.App.centerX+=e*p.App.map.settings.grid.size,p.App.centerY+=t*p.App.map.settings.grid.size},e.prototype.cmdCopySelection=function(){var a=this;this.copy.length=0;var n=!1,o=0,i=0;p.App.selection.get().forEach(function(e){if(!(e instanceof v.ConnectorView)){var t=e.getModel().clone();a.copy.push(t),n||(n=!0,o=t.x,i=t.y),t.x=-p.App.centerX+t.x-o,t.y=-p.App.centerY+t.y-i}}),p.App.selection.get().forEach(function(e){if(e instanceof v.ConnectorView){for(var t=e.getModel(),n=-1,o=-1,i=0,s=0;s<p.App.selection.size();s++)if(p.App.selection.get()[s]instanceof m.RoomView){var r=p.App.selection.get()[s];t.dockStart==r.getModel()&&(n=i),t.dockEnd==r.getModel()&&(o=i),i++}if(0<=n&&0<=o){var l=t.clone();l.dockStart=a.copy[n],l.dockEnd=a.copy[o],a.copy.push(l)}}})},e.prototype.cmdPaste=function(){var a=this;p.App.pushUndo(),p.App.selection.unselectAll();var c=this.views.length;this.copy.forEach(function(e){if(!(e instanceof f.Connector)){var t=e.clone();p.App.map.add(t);var n=y.ViewFactory.create(t);a.views.push(n),p.App.selection.add([n])}}),this.copy.forEach(function(e){if(e instanceof f.Connector){for(var t=e,n=0,o=0,i=0,s=0;s<a.copy.length;s++)a.copy[s]instanceof h.Room&&(t.dockStart==a.copy[s]&&(n=c+i),t.dockEnd==a.copy[s]&&(o=c+i),i++);var r=t.clone();p.App.map.add(r),r.dockStart=a.views[n].getModel(),r.dockEnd=a.views[o].getModel();var l=y.ViewFactory.create(r);a.views.push(l),p.App.selection.add([l])}})},e.prototype.cmdZoomIn=function(){10<=p.App.zoom||(p.App.zoom<1?p.App.zoom=p.App.zoom*d.Values.ZOOM_FRACTION:p.App.zoom+=d.Values.ZOOM_ADDITIVE)},e.prototype.cmdZoomOut=function(){p.App.zoom<=.1||(p.App.zoom<=1?p.App.zoom=p.App.zoom/d.Values.ZOOM_FRACTION:p.App.zoom-=d.Values.ZOOM_ADDITIVE)},e.prototype.cmdZoomNormal=function(){p.App.zoom=1},e.prototype.cmdCenterView=function(){p.App.centerX=0,p.App.centerY=0},e.prototype.cmdAddRoom=function(){p.App.pushUndo();var e=new h.Room(p.App.map.settings);p.App.map.add(e),e.x=u.Grid.snap(this.mouseX),e.y=u.Grid.snap(this.mouseY),this.views.push(y.ViewFactory.create(e))},e.prototype.cmdAddNote=function(){p.App.pushUndo();var e=new n.Note(p.App.map.settings);p.App.map.add(e),e.x=u.Grid.snap(this.mouseX),e.y=u.Grid.snap(this.mouseY),this.views.push(y.ViewFactory.create(e))},e.prototype.cmdAddBlock=function(){p.App.pushUndo();var e=new s.Block(p.App.map.settings);p.App.map.add(e),e.x=u.Grid.snap(this.mouseX),e.y=u.Grid.snap(this.mouseY),this.views.push(y.ViewFactory.create(e))},e}(),e("Editor",a)}}}),System.register("controls/idInput/idInput",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(e){if(this.elem=document.querySelector(e),!this.elem)throw"Failed to instantiate idInput: selector "+e+" not found in DOM.";var t=this.elem.dataset.label;this.elem.innerHTML=Handlebars.templates.idInput({label:t}),this.input=this.elem.querySelector("input")}return Object.defineProperty(e.prototype,"value",{get:function(){return this.input.value},set:function(e){this.input.value=e},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t){return this.input.addEventListener(e,t),this},e}(),e("IdInput",n)}}}),System.register("controls/idTextarea/idTextarea",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(e){if(this.elem=document.querySelector(e),!this.elem)throw"Failed to instantiate idTextarea: selector "+e+" not found in DOM.";var t=this.elem.dataset.label;this.elem.innerHTML=Handlebars.templates.idTextarea({label:t}),this.textarea=this.elem.querySelector("textarea")}return Object.defineProperty(e.prototype,"value",{get:function(){return this.textarea.value},set:function(e){this.textarea.value=e},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t){return this.textarea.addEventListener(e,t),this},e}(),e("IdTextarea",n)}}}),System.register("controls/idCheck/idCheck",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(e){if(this.elem=document.querySelector(e),!this.elem)throw"Failed to instantiate idCheck: selector "+e+" not found in DOM.";var t=this.elem.dataset.label;this.elem.innerHTML=Handlebars.templates.idCheck({label:t}),this.input=this.elem.querySelector("input")}return Object.defineProperty(e.prototype,"checked",{get:function(){return this.input.checked},set:function(e){this.input.checked=e},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t){return this.input.addEventListener(e,t),this},e}(),e("IdCheck",n)}}}),System.register("controls/idRange/idRange",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(e){var t=this;if(this.elem=document.querySelector(e),!this.elem)throw"Failed to instantiate idRange: selector "+e+" not found in DOM.";var n=this.elem.dataset.min;n||(n="0");var o=this.elem.dataset.max;o||(o="100"),this.elem.innerHTML=Handlebars.templates.idRange({min:n,max:o}),this.input=this.elem.querySelector("input"),this.label=this.elem.querySelector(".range-label"),this.input.value=n,this.updateLabel(),this.input.addEventListener("input",function(){t.updateLabel()})}return e.prototype.updateLabel=function(){this.label.innerHTML=this.input.value},Object.defineProperty(e.prototype,"value",{get:function(){return parseFloat(this.input.value)},set:function(e){this.input.value=e.toString(),this.updateLabel()},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t){return this.input.addEventListener(e,t),this},e}(),e("IdRange",n)}}}),System.register("controls/idColorPicker/idColorPicker",["controls/controls","enums/enums"],function(e,t){"use strict";var c,p,n;t&&t.id;return{setters:[function(e){c=e},function(e){p=e}],execute:function(){n=function(){function a(e){var n=this;if(this.currentHue=180,this.currentHSLX=150,this.currentHSLY=75,this.elem=document.querySelector(e),!this.elem)throw"Failed to instantiate IdColorPicker: selector "+e+" not found in DOM.";this.elem.innerHTML=Handlebars.templates.idColorPicker({recentcolors:a.recentColors,standardcolors:p.Values.COLORS_STANDARD});var t=this.elem.querySelectorAll("canvas");this.canvasHue=t[1],this.canvasHSL=t[0],this.ctxHue=this.canvasHue.getContext("2d"),this.ctxHSL=this.canvasHSL.getContext("2d"),this.currentColorElem=this.elem.querySelector(".current-color"),this.hoverColorElem=this.elem.querySelector(".hover-color");var o=this.elem.querySelectorAll(".recent id-popup");this.recentButtons=new Array;for(var i=function(e){var t=new c.IdPopup(o[e]);t.backgroundColor=a.recentColors[e],t.addEventListener("click",function(){n.pickColor(a.recentColors[e])}),s.recentButtons.push(t)},s=this,r=0;r<o.length;r++)i(r);o=this.elem.querySelectorAll(".standard id-popup");var l=function(e){var t=new c.IdPopup(o[e]);t.backgroundColor=p.Values.COLORS_STANDARD[e],t.addEventListener("click",function(){n.addToRecent(p.Values.COLORS_STANDARD[e]),n.pickColor(p.Values.COLORS_STANDARD[e])})};for(r=0;r<o.length;r++)l(r);this.drawHue(),this.drawHSL(),this.canvasHue.addEventListener("click",function(e){n.currentHue=360-360*(e.clientY-n.findObjCoordinates(n.canvasHue).y)/n.canvasHue.clientHeight,n.currentHSLX=-100,n.currentHSLY=-100,n.drawHue(),n.drawHSL()}),this.canvasHSL.addEventListener("mousemove",function(e){n.hoverColorElem.style.backgroundColor=n.getColorAtMouse(e.clientX,e.clientY,!1)}),this.canvasHSL.addEventListener("click",function(e){var t=n.getColorAtMouse(e.clientX,e.clientY,!0);n.drawHSL(),n.addToRecent(t),n.pickColor(t)}),window.addEventListener("id-recent-colors-changed",function(){n.updateRecentColors()})}return a.prototype.pickColor=function(e){this.color=e;var t=new CustomEvent("change");this.elem.dispatchEvent(t)},Object.defineProperty(a.prototype,"color",{get:function(){return this.currentColorElem.style.backgroundColor},set:function(e){this.currentColorElem.style.backgroundColor=e},enumerable:!0,configurable:!0}),a.prototype.addEventListener=function(e,t){return this.elem.addEventListener(e,t),this},a.prototype.addToRecent=function(e){a.recentColors.unshift(e),a.recentColors.pop();var t=new CustomEvent("id-recent-colors-changed");window.dispatchEvent(t)},a.prototype.updateRecentColors=function(){for(var e=0;e<this.recentButtons.length;e++)this.recentButtons[e].backgroundColor=a.recentColors[e]},a.prototype.getColorAtMouse=function(e,t,n){var o=this.findObjCoordinates(this.canvasHSL),i=o.x,s=o.y;i=Math.floor((e-i)*this.canvasHSL.width/this.canvasHSL.clientWidth),s=Math.floor((t-s)*this.canvasHSL.height/this.canvasHSL.clientHeight),n&&(this.currentHSLX=i,this.currentHSLY=s);var r=this.ctxHSL.getImageData(i,s,1,1);return"rgb("+r.data[0]+", "+r.data[1]+", "+r.data[2]+")"},a.prototype.findObjCoordinates=function(e){var t=0,n=0;if(e.offsetParent)for(;t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;);return{x:t,y:n}},a.prototype.drawHue=function(){this.ctxHue.save(),0<this.canvasHue.offsetWidth&&0<this.canvasHue.offsetHeight&&(this.canvasHue.width=this.canvasHue.offsetWidth,this.canvasHue.height=this.canvasHue.offsetHeight);for(var e=0;e<this.canvasHue.height;e++){var t=360-e/this.canvasHue.height*360;this.ctxHue.strokeStyle="hsl("+t+",100%,50%)",this.ctxHue.beginPath(),this.ctxHue.moveTo(0,e),this.ctxHue.lineTo(this.canvasHue.width,e),this.ctxHue.stroke()}if(0!=this.canvasHue.offsetWidth){this.ctxHue.strokeStyle="#000",this.ctxHue.lineWidth=1,this.ctxHue.beginPath();var n=this.canvasHue.width/2,o=(360-this.currentHue)/360*this.canvasHue.height;this.ctxHue.moveTo(n+5,o),this.ctxHue.arc(n,o,5,0,2*Math.PI,!1),this.ctxHue.stroke()}this.ctxHue.restore()},a.prototype.drawHSL=function(){this.ctxHSL.save(),0<this.canvasHSL.offsetWidth&&0<this.canvasHSL.offsetHeight&&(this.canvasHSL.width=this.canvasHSL.offsetWidth,this.canvasHSL.height=this.canvasHSL.offsetHeight);for(var e=0;e<this.canvasHSL.height;e++){var t=this.ctxHSL.createLinearGradient(0,0,this.canvasHSL.width,0),n=100*(this.canvasHSL.height-e)/this.canvasHSL.height;t.addColorStop(0,"hsl("+this.currentHue+", 100%, "+n+"%)"),t.addColorStop(1,"hsl("+this.currentHue+", 0%, "+n+"%)"),this.ctxHSL.fillStyle=t,this.ctxHSL.fillRect(0,e,this.canvasHSL.width,1)}if(0!=this.canvasHSL.offsetWidth){this.ctxHSL.strokeStyle="#000",this.ctxHSL.lineWidth=1,this.ctxHSL.beginPath();var o=this.currentHSLX,i=this.currentHSLY;this.ctxHSL.moveTo(o+5,i),this.ctxHSL.arc(o,i,5,0,2*Math.PI,!1),this.ctxHSL.stroke()}this.ctxHSL.restore()},a.recentColors=["#ffffff","#ffffff","#ffffff"],a}(),e("IdColorPicker",n)}}}),System.register("controls/idPopup/idPopup",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(e){var t=this;if(e instanceof HTMLElement)this.elem=e;else if(this.elem=document.querySelector(e),!this.elem)throw"Failed to instantiate idPopup: selector "+e+" not found in DOM.";for(var n=new Array,o=0;o<this.elem.children.length;o++)n.push(this.elem.children[o]);n.forEach(function(e){e.remove()}),this.elem.innerHTML=Handlebars.templates.idPopup({}),this.div=this.elem.querySelector("div"),n.forEach(function(e){t.div.appendChild(e)}),this.setupOverlay()}return e.prototype.findObjCoordinates=function(e){var t=0,n=0;if(e.offsetParent)for(;t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;);return{x:t,y:n}},e.prototype.setupOverlay=function(){var s=this,r=this.elem.querySelector(".popup-overlay");r&&(r.style.display="none",this.elem.addEventListener("click",function(e){if(window.getSelection().removeAllRanges(),"none"==r.style.display){for(var t=document.querySelectorAll(".popup-overlay"),n=0;n<t.length;n++)t[n].style.display="none";r.style.display="block";var o=s.findObjCoordinates(s.elem),i=o.x;o.y;i+r.offsetWidth>window.innerWidth&&(r.style.left=window.innerWidth-(i+r.offsetWidth)+"px")}else r.style.display="none"}),r.addEventListener("click",function(e){e.stopPropagation()}))},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this.div.style.backgroundColor},set:function(e){this.div.style.backgroundColor=e},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t){return this.elem.addEventListener(e,t),this},e}(),e("IdPopup",n)}}}),System.register("controls/tabs",[],function(e,t){"use strict";var n,o;t&&t.id;return{setters:[],execute:function(){n=function(){function n(e){this.elem=e,this.tabs=new Array;for(var t=this.elem.querySelectorAll(".tab"),n=0;n<t.length;n++)this.tabs.push(new o(this,t[n]))}return n.initialize=function(){for(var e=document.querySelectorAll(".tabs"),t=0;t<e.length;t++)new n(e[t])},n.prototype.select=function(e){for(var t=0;t<this.tabs.length;t++)this.tabs[t]==e?this.tabs[t].select():this.tabs[t].unselect()},n}(),e("Tabs",n),o=function(){function e(e,t){var n=this;this.tabs=e,this.elem=t;var o=this.elem.dataset.body;this.body=document.getElementById(o),this.body?(this.elem.classList.contains("selected")&&this.select(),this.elem.addEventListener("click",function(){n.tabs.select(n)})):console.log("Tabs error: body not found.")}return e.prototype.select=function(){this.elem.classList.add("selected"),this.body.classList.add("selected")},e.prototype.unselect=function(){this.elem.classList.remove("selected"),this.body.classList.remove("selected")},e}()}}}),System.register("controls/window",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(e,t,n,o){var i=this;this.elem=document.getElementById("window"),this.elem.querySelector(".title").innerHTML=e,this.elem.querySelector(".content").innerHTML=t,this.elem.querySelector(".ok").style.display=!1===n?"none":"block",this.elem.querySelector(".ok").addEventListener("click",function(){i.close(),n instanceof Function&&n()}),this.elem.querySelector(".cancel").style.display=!1===o?"none":"block",this.elem.querySelector(".cancel").addEventListener("click",function(){i.close(),o instanceof Function&&o()}),this.open()}return e.prototype.open=function(){this.elem.style.display="flex"},e.prototype.close=function(){this.elem.style.display="none"},e}(),e("Window",n)}}}),System.register("controls/controls",["controls/idInput/idInput","controls/idTextarea/idTextarea","controls/idCheck/idCheck","controls/idRange/idRange","controls/idColorPicker/idColorPicker","controls/idPopup/idPopup","controls/tabs","controls/window"],function(o,e){"use strict";e&&e.id;function t(e){var t={};for(var n in e)"default"!==n&&(t[n]=e[n]);o(t)}return{setters:[function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)}],execute:function(){}}}),System.register("popups/popup",[],function(e,t){"use strict";t&&t.id;return{setters:[],execute:function(){e("Popup",function(e,t,n){this.id=e,this.elem=document.getElementById(e),this.elem.innerHTML=t(n)})}}}),System.register("popups/connectorPopup/connectorPopup",["app","dispatcher","enums/enums","views/connectorView","popups/popups","controls/controls"],function(e,t){"use strict";var i,s,r,l,n,a,o;t&&t.id;return{setters:[function(e){i=e},function(e){s=e},function(e){r=e},function(e){l=e},function(e){n=e},function(e){a=e}],execute:function(){o=function(t){function e(){var n=t.call(this,"connectorpopup",Handlebars.templates.connectorPopup,{colors:r.Values.COLORS_STANDARD})||this;s.Dispatcher.subscribe(n),new a.IdPopup("#connectorpopup .js-color"),new a.IdPopup("#connectorpopup .js-line"),new a.IdPopup("#connectorpopup .js-basic"),new a.IdPopup("#connectorpopup .js-delete").addEventListener("click",function(){n.deleteConnector()}),new a.IdPopup("#connectorpopup .js-more").addEventListener("click",function(){n.showMore()}),n.ctrlName=new a.IdInput(".js-name").addEventListener("input",function(){n.connector.name=n.ctrlName.value});for(var o=n.elem.querySelectorAll(".js-color id-popup"),e=function(){var e=new a.IdPopup(o[i]),t=r.Values.COLORS_STANDARD[i];e.backgroundColor=t,e.addEventListener("click",function(){n.setColor(t)})},i=0;i<o.length;i++)e();return new a.IdPopup("#connectorpopup .js-linestyle-solid").addEventListener("click",function(){n.connector.lineStyle=r.LineStyle.Solid}),new a.IdPopup("#connectorpopup .js-linestyle-dash").addEventListener("click",function(){n.connector.lineStyle=r.LineStyle.Dash}),new a.IdPopup("#connectorpopup .js-linestyle-dashdot").addEventListener("click",function(){n.connector.lineStyle=r.LineStyle.DashDot}),new a.IdPopup("#connectorpopup .js-linestyle-dashdotdot").addEventListener("click",function(){n.connector.lineStyle=r.LineStyle.DashDotDot}),new a.IdPopup("#connectorpopup .js-linestyle-dot").addEventListener("click",function(){n.connector.lineStyle=r.LineStyle.Dot}),n.ctrlLinewidth=new a.IdRange("#connectorpopup .js-linewidth").addEventListener("input",function(){n.connector.lineWidth=n.ctrlLinewidth.value}),n}return __extends(e,t),e.prototype.notify=function(e,t){e!=r.AppEvent.MouseMove&&e!=r.AppEvent.Select||this.toggle()},e.prototype.setColor=function(e){this.connector.color=e},e.prototype.deleteConnector=function(){i.App.pushUndo(),this.connector.delete(),this.toggle()},e.prototype.showMore=function(){s.Dispatcher.notify(r.AppEvent.More,this.connector)},e.prototype.toggle=function(){if(i.App.selection.isSingle()&&i.App.selection.first()instanceof l.ConnectorView&&i.App.mouseMode==r.MouseMode.None){this.connector=i.App.selection.first().getModel();var e=this.connector.dockStart?this.connector.dockStart.x:this.connector.startX,t=this.connector.dockStart?this.connector.dockStart.y:this.connector.startY;this.elem.style.left=i.App.canvas.offsetWidth/2+i.App.centerX+e*i.App.zoom+"px",this.elem.style.top=i.App.canvas.offsetHeight/2+i.App.centerY+t-64+"px",this.elem.style.display="flex";for(var n=this.elem.querySelectorAll(".popup-overlay"),o=0;o<n.length;o++)n[o].style.display="none";this.ctrlName.value=this.connector.name,this.ctrlLinewidth.value=this.connector.lineWidth}else this.elem.style.display="none"},e}(n.Popup),e("ConnectorPopup",o)}}}),System.register("popups/notePopup/notePopup",["app","dispatcher","enums/enums","views/noteView","popups/popups","controls/controls"],function(e,t){"use strict";var n,s,r,o,i,l,a;t&&t.id;return{setters:[function(e){n=e},function(e){s=e},function(e){r=e},function(e){o=e},function(e){i=e},function(e){l=e}],execute:function(){a=function(t){function e(){var n=t.call(this,"notepopup",Handlebars.templates.notePopup,{colors:r.Values.COLORS_STANDARD})||this;s.Dispatcher.subscribe(n),new l.IdPopup("#notepopup .js-basic"),new l.IdPopup("#notepopup .js-color"),new l.IdPopup("#notepopup .js-line"),new l.IdPopup("#notepopup .js-position"),new l.IdPopup("#notepopup .js-delete").addEventListener("click",function(){n.deleteNote()}),new l.IdPopup("#notepopup .js-more").addEventListener("click",function(){n.showMore()}),n.ctrlText=new l.IdInput(".js-text").addEventListener("input",function(){n.note.text=n.ctrlText.value});for(var o=n.elem.querySelectorAll(".js-color id-popup"),e=function(){var e=new l.IdPopup(o[i]),t=r.Values.COLORS_STANDARD[i];e.backgroundColor=t,e.addEventListener("click",function(){n.setColor(t)})},i=0;i<o.length;i++)e();return new l.IdPopup("#notepopup .js-linestyle-solid").addEventListener("click",function(){n.note.lineStyle=r.LineStyle.Solid}),new l.IdPopup("#notepopup .js-linestyle-dash").addEventListener("click",function(){n.note.lineStyle=r.LineStyle.Dash}),new l.IdPopup("#notepopup .js-linestyle-dashdot").addEventListener("click",function(){n.note.lineStyle=r.LineStyle.DashDot}),new l.IdPopup("#notepopup .js-linestyle-dashdotdot").addEventListener("click",function(){n.note.lineStyle=r.LineStyle.DashDotDot}),new l.IdPopup("#notepopup .js-linestyle-dot").addEventListener("click",function(){n.note.lineStyle=r.LineStyle.Dot}),new l.IdPopup("#notepopup .js-linestyle-none").addEventListener("click",function(){n.note.lineStyle=r.LineStyle.None}),n.ctrlLinewidth=new l.IdRange("#notepopup .js-linewidth").addEventListener("input",function(){n.note.lineWidth=n.ctrlLinewidth.value}),n.elem.querySelector(".js-front").addEventListener("click",function(){n.note.bringToFront(),s.Dispatcher.notify(r.AppEvent.Load,null)}),n.elem.querySelector(".js-forward").addEventListener("click",function(){n.note.bringForward(),s.Dispatcher.notify(r.AppEvent.Load,null)}),n.elem.querySelector(".js-backward").addEventListener("click",function(){n.note.sendBackward(),s.Dispatcher.notify(r.AppEvent.Load,null)}),n.elem.querySelector(".js-back").addEventListener("click",function(){n.note.sendToBack(),s.Dispatcher.notify(r.AppEvent.Load,null)}),n}return __extends(e,t),e.prototype.notify=function(e,t){e!=r.AppEvent.MouseMove&&e!=r.AppEvent.Select||this.toggle()},e.prototype.setColor=function(e){this.note.fillColor=e},e.prototype.deleteNote=function(){n.App.pushUndo(),this.note.delete(),this.toggle()},e.prototype.showMore=function(){s.Dispatcher.notify(r.AppEvent.More,this.note)},e.prototype.toggle=function(){if(n.App.selection.isSingle()&&n.App.selection.first()instanceof o.NoteView&&n.App.mouseMode==r.MouseMode.None){this.note=n.App.selection.first().getModel(),this.elem.style.left=n.App.canvas.offsetWidth/2+n.App.centerX+this.note.x*n.App.zoom+"px",this.elem.style.top=n.App.canvas.offsetHeight/2+n.App.centerY+this.note.y-64+"px",this.elem.style.display="flex";for(var e=this.elem.querySelectorAll(".popup-overlay"),t=0;t<e.length;t++)e[t].style.display="none";this.ctrlText.value=this.note.text,this.ctrlLinewidth.value=this.note.lineWidth}else this.elem.style.display="none"},e}(i.Popup),e("NotePopup",a)}}}),System.register("popups/roomPopup/roomPopup",["app","dispatcher","enums/enums","views/roomView","popups/popups","controls/controls"],function(e,t){"use strict";var n,s,r,o,i,l,a;t&&t.id;return{setters:[function(e){n=e},function(e){s=e},function(e){r=e},function(e){o=e},function(e){i=e},function(e){l=e}],execute:function(){a=function(t){function e(){var n=t.call(this,"roompopup",Handlebars.templates.roomPopup,{colors:r.Values.COLORS_STANDARD})||this;s.Dispatcher.subscribe(n),new l.IdPopup("#roompopup .js-basic"),new l.IdPopup("#roompopup .js-fill"),new l.IdPopup("#roompopup .js-border"),new l.IdPopup("#roompopup .js-position"),new l.IdPopup("#roompopup .js-delete").addEventListener("click",function(){n.deleteRoom()}),new l.IdPopup("#roompopup .js-more").addEventListener("click",function(){n.showMore()}),n.elem.querySelector(".js-front").addEventListener("click",function(){n.room.bringToFront(),s.Dispatcher.notify(r.AppEvent.Load,null)}),n.elem.querySelector(".js-forward").addEventListener("click",function(){n.room.bringForward(),s.Dispatcher.notify(r.AppEvent.Load,null)}),n.elem.querySelector(".js-backward").addEventListener("click",function(){n.room.sendBackward(),s.Dispatcher.notify(r.AppEvent.Load,null)}),n.elem.querySelector(".js-back").addEventListener("click",function(){n.room.sendToBack(),s.Dispatcher.notify(r.AppEvent.Load,null)}),n.ctrlName=new l.IdInput(".js-name").addEventListener("input",function(){n.room.name=n.ctrlName.value}),n.ctrlSubtitle=new l.IdInput(".js-subtitle").addEventListener("input",function(){n.room.subtitle=n.ctrlSubtitle.value});for(var o=n.elem.querySelectorAll(".js-fill id-popup"),e=function(){var e=new l.IdPopup(o[i]),t=r.Values.COLORS_STANDARD[i];e.backgroundColor=t,e.addEventListener("click",function(){n.setColor(t)})},i=0;i<o.length;i++)e();return new l.IdPopup("#roompopup .js-linestyle-solid").addEventListener("click",function(){n.room.lineStyle=r.LineStyle.Solid}),new l.IdPopup("#roompopup .js-linestyle-dash").addEventListener("click",function(){n.room.lineStyle=r.LineStyle.Dash}),new l.IdPopup("#roompopup .js-linestyle-dashdot").addEventListener("click",function(){n.room.lineStyle=r.LineStyle.DashDot}),new l.IdPopup("#roompopup .js-linestyle-dashdotdot").addEventListener("click",function(){n.room.lineStyle=r.LineStyle.DashDotDot}),new l.IdPopup("#roompopup .js-linestyle-dot").addEventListener("click",function(){n.room.lineStyle=r.LineStyle.Dot}),new l.IdPopup("#roompopup .js-linestyle-none").addEventListener("click",function(){n.room.lineStyle=r.LineStyle.None}),n.ctrlLinewidth=new l.IdRange("#roompopup .js-linewidth").addEventListener("input",function(){n.room.lineWidth=n.ctrlLinewidth.value}),n}return __extends(e,t),e.prototype.notify=function(e,t){e!=r.AppEvent.MouseMove&&e!=r.AppEvent.Select||this.toggle()},e.prototype.setColor=function(e){this.room.fillColor=e},e.prototype.deleteRoom=function(){n.App.pushUndo(),this.room.delete(),this.toggle()},e.prototype.showMore=function(){s.Dispatcher.notify(r.AppEvent.More,this.room)},e.prototype.toggle=function(){if(n.App.selection.isSingle()&&n.App.selection.first()instanceof o.RoomView&&n.App.mouseMode==r.MouseMode.None){this.room=n.App.selection.first().getModel(),this.elem.style.left=n.App.canvas.offsetWidth/2+n.App.centerX+this.room.x*n.App.zoom+"px",this.elem.style.top=n.App.canvas.offsetHeight/2+n.App.centerY+this.room.y-64+"px",this.elem.style.display="flex";for(var e=this.elem.querySelectorAll(".popup-overlay"),t=0;t<e.length;t++)e[t].style.display="none";this.ctrlLinewidth.value=this.room.lineWidth,this.ctrlName.value=this.room.name,this.ctrlSubtitle.value=this.room.subtitle}else this.elem.style.display="none"},e}(i.Popup),e("RoomPopup",a)}}}),System.register("popups/popups",["popups/popup","popups/connectorPopup/connectorPopup","popups/notePopup/notePopup","popups/roomPopup/roomPopup"],function(o,e){"use strict";e&&e.id;function t(e){var t={};for(var n in e)"default"!==n&&(t[n]=e[n]);o(t)}return{setters:[function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)}],execute:function(){}}}),System.register("panels/panel",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(e,t,n){var o=this;this.id=e,this.elem=document.getElementById(e),Handlebars.registerPartial("closePanel",Handlebars.templates.closePanel),this.elem.innerHTML=t(n);var i=document.querySelector("#"+e+" .panel-close");i&&i.addEventListener("click",function(){o.close()}),document.getElementById("canvas").addEventListener("mousedown",function(){o.close()})}return e.prototype.open=function(){this.elem.classList.add("show")},e.prototype.close=function(){this.elem.classList.remove("show")},e.prototype.toggle=function(){this.elem.classList.contains("show")?this.close():this.open()},e}(),e("Panel",n)}}}),System.register("controls/idRadio/idRadio",[],function(e,t){"use strict";var n;t&&t.id;return{setters:[],execute:function(){n=function(){function e(e,t){if(this.elem=t?t.querySelector(e):document.querySelector(e),!this.elem)throw"Failed to instantiate idRadio: selector "+e+" not found in DOM.";var n=this.elem.dataset.label,o=this.elem.dataset.name;this.elem.innerHTML=Handlebars.templates.idRadio({label:n,name:o}),this.input=this.elem.querySelector("input")}return Object.defineProperty(e.prototype,"checked",{get:function(){return this.input.checked},set:function(e){this.input.checked=e},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t){return this.input.addEventListener(e,t),this},e}(),e("IdRadio",n)}}}),System.register("controls/idConnectorType/idConnectorType",["controls/idRadio/idRadio","enums/connectorType"],function(e,t){"use strict";var n,o,i;t&&t.id;return{setters:[function(e){n=e},function(e){o=e}],execute:function(){i=function(){function t(e){if(this.elem=document.querySelector(e),!this.elem)throw"Failed to instantiate idConnectorType: selector "+e+" not found in DOM.";this.elem.innerHTML=Handlebars.templates.idConnectorType({name:"connector"+t.id}),t.id++,this.radioDefault=new n.IdRadio(".js-default",this.elem),this.radioIn=new n.IdRadio(".js-in",this.elem),this.radioOut=new n.IdRadio(".js-out",this.elem),this.radioUp=new n.IdRadio(".js-up",this.elem),this.radioDown=new n.IdRadio(".js-down",this.elem)}return Object.defineProperty(t.prototype,"value",{get:function(){return this.radioIn.checked?o.ConnectorType.In:this.radioOut.checked?o.ConnectorType.Out:this.radioUp.checked?o.ConnectorType.Up:this.radioDown.checked?o.ConnectorType.Down:o.ConnectorType.Default},set:function(e){switch(e){case o.ConnectorType.Default:this.radioDefault.checked=!0;break;case o.ConnectorType.In:this.radioIn.checked=!0;break;case o.ConnectorType.Out:this.radioOut.checked=!0;break;case o.ConnectorType.Up:this.radioUp.checked=!0;break;case o.ConnectorType.Down:this.radioDown.checked=!0}},enumerable:!0,configurable:!0}),t.prototype.addEventListener=function(e,t){return this.radioDefault.addEventListener(e,t),this.radioIn.addEventListener(e,t),this.radioOut.addEventListener(e,t),this.radioUp.addEventListener(e,t),this.radioDown.addEventListener(e,t),this},t.id=0,t}(),e("IdConnectorType",i)}}}),System.register("panels/connectorPanel/connectorPanel",["dispatcher","enums/appEvent","models/connector","app","panels/panels","controls/controls","controls/idConnectorType/idConnectorType"],function(e,t){"use strict";var n,o,i,s,r,l,a,c;t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e},function(e){s=e},function(e){r=e},function(e){l=e},function(e){a=e}],execute:function(){c=function(t){function e(){var e=t.call(this,"connectorpanel",Handlebars.templates.connectorPanel,{})||this;return n.Dispatcher.subscribe(e),e.ctrlName=new l.IdInput("#connectorpanel .js-connector-name").addEventListener("input",function(){e.connector.name=e.ctrlName.value}),e.ctrlCurve=new l.IdCheck("#connectorpanel .js-connector-curve").addEventListener("input",function(){e.connector.isCurve=e.ctrlCurve.checked}),e.ctrlOneWay=new l.IdCheck("#connectorpanel .js-connector-oneway").addEventListener("input",function(){e.connector.oneWay=e.ctrlOneWay.checked}),e.ctrlColor=new l.IdColorPicker("#connectorpanel .js-connector-color").addEventListener("change",function(){e.connector.color=e.ctrlColor.color}),e.btnReverse=e.elem.querySelector(".js-reverse"),e.btnReverse.addEventListener("click",function(){s.App.pushUndo(),e.connector.reverse()}),e.ctrlStartType=new a.IdConnectorType("#connectorpanel .js-connector-starttype").addEventListener("input",function(){e.connector.startType=e.ctrlStartType.value}),e.ctrlEndType=new a.IdConnectorType("#connectorpanel .js-connector-endtype").addEventListener("input",function(){e.connector.endType=e.ctrlEndType.value}),e.ctrlStartLabel=new l.IdInput("#connectorpanel .js-connector-startlabel").addEventListener("input",function(){e.connector.startLabel=e.ctrlStartLabel.value}),e.ctrlEndLabel=new l.IdInput("#connectorpanel .js-connector-endlabel").addEventListener("input",function(){e.connector.endLabel=e.ctrlEndLabel.value}),e}return __extends(e,t),e.prototype.notify=function(e,t){if(e==o.AppEvent.Select&&this.close(),e==o.AppEvent.More)if(t instanceof i.Connector){var n=t;this.connector=n,this.open(),this.ctrlName.value=n.name,this.ctrlCurve.checked=n.isCurve,this.ctrlOneWay.checked=n.oneWay,this.ctrlColor.color=n.color,this.btnReverse.style.display=n.isDoubleDocked()?"block":"none",this.ctrlStartType.value=n.startType,this.ctrlEndType.value=n.endType,this.ctrlStartLabel.value=n.startLabel,this.ctrlEndLabel.value=n.endLabel}else this.close()},e}(r.Panel),e("ConnectorPanel",c)}}}),System.register("panels/mapPanel/mapPanel",["dispatcher","enums/appEvent","app","enums/enums","panels/panels","controls/controls","models/map"],function(e,t){"use strict";var p,n,d,u,o,h,i,s;t&&t.id;return{setters:[function(e){p=e},function(e){n=e},function(e){d=e},function(e){u=e},function(e){o=e},function(e){h=e},function(e){i=e}],execute:function(){s=function(c){function e(){var n=c.call(this,"mappanel",Handlebars.templates.mapPanel,{assets:u.Values.BITMAP_ASSETS})||this;p.Dispatcher.subscribe(n),n.ctrlTitle=new h.IdInput("#mappanel .js-map-title").addEventListener("input",function(){d.App.map.title=n.ctrlTitle.value}),n.ctrlAuthor=new h.IdInput("#mappanel .js-map-author").addEventListener("input",function(){d.App.map.author=n.ctrlAuthor.value}),n.ctrlDescription=new h.IdTextarea("#mappanel .js-map-description").addEventListener("input",function(){d.App.map.description=n.ctrlDescription.value}),n.ctrlGridVisible=new h.IdCheck("#mappanel .js-map-grid-visible").addEventListener("input",function(){d.App.map.settings.grid.visible=n.ctrlGridVisible.checked}),n.ctrlGridOrigin=new h.IdCheck("#mappanel .js-map-grid-origin").addEventListener("input",function(){d.App.map.settings.grid.origin=n.ctrlGridOrigin.checked}),n.ctrlGridSnap=new h.IdCheck("#mappanel .js-map-grid-snap").addEventListener("input",function(){d.App.map.settings.grid.snap=n.ctrlGridSnap.checked}),n.ctrlGridSize=new h.IdRange("#mappanel .js-map-grid-size").addEventListener("input",function(){d.App.map.settings.grid.size=n.ctrlGridSize.value}),new h.IdPopup("#mappanel .js-map-bg-none").addEventListener("click",function(){d.App.map.settings.background="none"}),u.Values.BITMAP_ASSETS.forEach(function(e){new h.IdPopup("#mappanel .js-map-bg-"+e).addEventListener("click",function(){d.App.map.settings.background=e})}),n.ctrlRoomWidth=new h.IdRange("#mappanel .js-map-room-width").addEventListener("input",function(){d.App.map.settings.room.width=n.ctrlRoomWidth.value}),n.ctrlRoomHeight=new h.IdRange("#mappanel .js-map-room-height").addEventListener("input",function(){d.App.map.settings.room.height=n.ctrlRoomHeight.value}),n.ctrlRoomLinewidth=new h.IdRange("#mappanel .js-map-room-linewidth").addEventListener("input",function(){d.App.map.settings.room.lineWidth=n.ctrlRoomLinewidth.value}),n.ctrlRoomRounding=new h.IdRange("#mappanel .js-map-room-rounding").addEventListener("input",function(){d.App.map.settings.room.rounding=n.ctrlRoomRounding.value}),n.ctrlRoomDarknessSize=new h.IdRange("#mappanel .js-map-room-darkness-size").addEventListener("input",function(){d.App.map.settings.room.darknessSize=n.ctrlRoomDarknessSize.value}),new h.IdPopup("#mappanel .js-room-shape-rectangle").addEventListener("click",function(){d.App.map.settings.room.shape=u.RoomShape.Rectangle}),new h.IdPopup("#mappanel .js-room-shape-ellipse").addEventListener("click",function(){d.App.map.settings.room.shape=u.RoomShape.Ellipse}),new h.IdPopup("#mappanel .js-room-shape-octagon").addEventListener("click",function(){d.App.map.settings.room.shape=u.RoomShape.Octagon}),new h.IdPopup("#mappanel .js-room-linestyle-solid").addEventListener("click",function(){d.App.map.settings.room.lineStyle=u.LineStyle.Solid}),new h.IdPopup("#mappanel .js-room-linestyle-dash").addEventListener("click",function(){d.App.map.settings.room.lineStyle=u.LineStyle.Dash}),new h.IdPopup("#mappanel .js-room-linestyle-dashdot").addEventListener("click",function(){d.App.map.settings.room.lineStyle=u.LineStyle.DashDot}),new h.IdPopup("#mappanel .js-room-linestyle-dashdotdot").addEventListener("click",function(){d.App.map.settings.room.lineStyle=u.LineStyle.DashDotDot}),new h.IdPopup("#mappanel .js-room-linestyle-dot").addEventListener("click",function(){d.App.map.settings.room.lineStyle=u.LineStyle.Dot}),new h.IdPopup("#mappanel .js-room-linestyle-none").addEventListener("click",function(){d.App.map.settings.room.lineStyle=u.LineStyle.None}),n.roomColorPicker=new h.IdColorPicker("#mappanel .js-map-room-color").addEventListener("change",function(){n.setRoomColor(n.roomColorPicker.color)});var o=document.querySelectorAll("#mappanel .room-colortype");n.roomColorButtons=new Array;for(var e=function(e){var t=new h.IdPopup(o[e]);t.elem.classList.contains("selected")&&(i.roomColorType=t.elem.dataset.type),i.roomColorButtons.push(t),o[e].addEventListener("click",function(){n.onRoomColorButton(t)})},i=this,t=0;t<o.length;t++)e(t);n.ctrlConnectorLinewidth=new h.IdRange("#mappanel .js-map-connector-linewidth").addEventListener("input",function(){d.App.map.settings.connector.lineWidth=n.ctrlConnectorLinewidth.value}),n.ctrlConnectorStalk=new h.IdRange("#mappanel .js-map-connector-stalk").addEventListener("input",function(){d.App.map.settings.connector.stalk=n.ctrlConnectorStalk.value}),n.ctrlConnectorLabelDistance=new h.IdRange("#mappanel .js-map-connector-label-distance").addEventListener("input",function(){d.App.map.settings.connector.labelDistance=n.ctrlConnectorLabelDistance.value}),n.ctrlConnectorArrowSize=new h.IdRange("#mappanel .js-map-connector-arrow-size").addEventListener("input",function(){d.App.map.settings.connector.arrowSize=n.ctrlConnectorArrowSize.value}),n.ctrlConnectorCurve=new h.IdCheck("#mappanel .js-map-connector-curve").addEventListener("input",function(){d.App.map.settings.connector.isCurve=n.ctrlConnectorCurve.checked}),n.ctrlConnectorCurveStrength=new h.IdRange("#mappanel .js-map-connector-curve-strength").addEventListener("input",function(){d.App.map.settings.connector.curveStrength=n.ctrlConnectorCurveStrength.value/10}),new h.IdPopup("#mappanel .js-connector-linestyle-solid").addEventListener("click",function(){d.App.map.settings.connector.lineStyle=u.LineStyle.Solid}),new h.IdPopup("#mappanel .js-connector-linestyle-dash").addEventListener("click",function(){d.App.map.settings.connector.lineStyle=u.LineStyle.Dash}),new h.IdPopup("#mappanel .js-connector-linestyle-dashdot").addEventListener("click",function(){d.App.map.settings.connector.lineStyle=u.LineStyle.DashDot}),new h.IdPopup("#mappanel .js-connector-linestyle-dashdotdot").addEventListener("click",function(){d.App.map.settings.connector.lineStyle=u.LineStyle.DashDotDot}),new h.IdPopup("#mappanel .js-connector-linestyle-dot").addEventListener("click",function(){d.App.map.settings.connector.lineStyle=u.LineStyle.Dot}),n.connectorColorPicker=new h.IdColorPicker("#mappanel .js-map-connector-color").addEventListener("change",function(){d.App.map.settings.connector.color=n.connectorColorPicker.color}),n.ctrlNoteWidth=new h.IdRange("#mappanel .js-map-note-width").addEventListener("input",function(){d.App.map.settings.note.width=n.ctrlNoteWidth.value}),n.ctrlNoteHeight=new h.IdRange("#mappanel .js-map-note-height").addEventListener("input",function(){d.App.map.settings.note.height=n.ctrlNoteHeight.value}),n.ctrlNoteLinewidth=new h.IdRange("#mappanel .js-map-note-linewidth").addEventListener("input",function(){d.App.map.settings.note.lineWidth=n.ctrlNoteLinewidth.value}),n.ctrlNoteRounding=new h.IdRange("#mappanel .js-map-note-rounding").addEventListener("input",function(){d.App.map.settings.note.rounding=n.ctrlNoteRounding.value}),new h.IdPopup("#mappanel .js-note-shape-rectangle").addEventListener("click",function(){d.App.map.settings.note.shape=u.RoomShape.Rectangle}),new h.IdPopup("#mappanel .js-note-shape-ellipse").addEventListener("click",function(){d.App.map.settings.note.shape=u.RoomShape.Ellipse}),new h.IdPopup("#mappanel .js-note-shape-octagon").addEventListener("click",function(){d.App.map.settings.note.shape=u.RoomShape.Octagon}),new h.IdPopup("#mappanel .js-note-linestyle-solid").addEventListener("click",function(){d.App.map.settings.note.lineStyle=u.LineStyle.Solid}),new h.IdPopup("#mappanel .js-note-linestyle-dash").addEventListener("click",function(){d.App.map.settings.note.lineStyle=u.LineStyle.Dash}),new h.IdPopup("#mappanel .js-note-linestyle-dashdot").addEventListener("click",function(){d.App.map.settings.note.lineStyle=u.LineStyle.DashDot}),new h.IdPopup("#mappanel .js-note-linestyle-dashdotdot").addEventListener("click",function(){d.App.map.settings.note.lineStyle=u.LineStyle.DashDotDot}),new h.IdPopup("#mappanel .js-note-linestyle-dot").addEventListener("click",function(){d.App.map.settings.note.lineStyle=u.LineStyle.Dot}),new h.IdPopup("#mappanel .js-note-linestyle-none").addEventListener("click",function(){d.App.map.settings.note.lineStyle=u.LineStyle.None}),n.noteColorPicker=new h.IdColorPicker("#mappanel .js-map-note-color").addEventListener("change",function(){n.setNoteColor(n.noteColorPicker.color)});o=document.querySelectorAll("#mappanel .note-colortype");n.noteColorButtons=new Array;var s=function(e){var t=new h.IdPopup(o[e]);t.elem.classList.contains("selected")&&(r.noteColorType=t.elem.dataset.type),r.noteColorButtons.push(t),o[e].addEventListener("click",function(){n.onNoteColorButton(t)})},r=this;for(t=0;t<o.length;t++)s(t);n.ctrlBlockWidth=new h.IdRange("#mappanel .js-map-block-width").addEventListener("input",function(){d.App.map.settings.block.width=n.ctrlBlockWidth.value}),n.ctrlBlockHeight=new h.IdRange("#mappanel .js-map-block-height").addEventListener("input",function(){d.App.map.settings.block.height=n.ctrlBlockHeight.value}),n.ctrlBlockLinewidth=new h.IdRange("#mappanel .js-map-block-linewidth").addEventListener("input",function(){d.App.map.settings.block.lineWidth=n.ctrlBlockLinewidth.value}),n.ctrlBlockRounding=new h.IdRange("#mappanel .js-map-block-rounding").addEventListener("input",function(){d.App.map.settings.block.rounding=n.ctrlBlockRounding.value}),new h.IdPopup("#mappanel .js-block-shape-rectangle").addEventListener("click",function(){d.App.map.settings.block.shape=u.RoomShape.Rectangle}),new h.IdPopup("#mappanel .js-block-shape-ellipse").addEventListener("click",function(){d.App.map.settings.block.shape=u.RoomShape.Ellipse}),new h.IdPopup("#mappanel .js-block-shape-octagon").addEventListener("click",function(){d.App.map.settings.block.shape=u.RoomShape.Octagon}),new h.IdPopup("#mappanel .js-block-linestyle-solid").addEventListener("click",function(){d.App.map.settings.block.lineStyle=u.LineStyle.Solid}),new h.IdPopup("#mappanel .js-block-linestyle-dash").addEventListener("click",function(){d.App.map.settings.block.lineStyle=u.LineStyle.Dash}),new h.IdPopup("#mappanel .js-block-linestyle-dashdot").addEventListener("click",function(){d.App.map.settings.block.lineStyle=u.LineStyle.DashDot}),new h.IdPopup("#mappanel .js-block-linestyle-dashdotdot").addEventListener("click",function(){d.App.map.settings.block.lineStyle=u.LineStyle.DashDotDot}),new h.IdPopup("#mappanel .js-block-linestyle-dot").addEventListener("click",function(){d.App.map.settings.block.lineStyle=u.LineStyle.Dot}),new h.IdPopup("#mappanel .js-block-linestyle-none").addEventListener("click",function(){d.App.map.settings.block.lineStyle=u.LineStyle.None}),n.blockColorPicker=new h.IdColorPicker("#mappanel .js-map-block-color").addEventListener("change",function(){n.setBlockColor(n.blockColorPicker.color)});o=document.querySelectorAll("#mappanel .block-colortype");n.blockColorButtons=new Array;var l=function(e){var t=new h.IdPopup(o[e]);t.elem.classList.contains("selected")&&(a.blockColorType=t.elem.dataset.type),a.blockColorButtons.push(t),o[e].addEventListener("click",function(){n.onBlockColorButton(t)})},a=this;for(t=0;t<o.length;t++)l(t);return n}return __extends(e,c),e.prototype.notify=function(e,t){e==n.AppEvent.More&&(t instanceof i.Map?(this.open(),this.ctrlTitle.value=d.App.map.title,this.ctrlAuthor.value=d.App.map.author,this.ctrlDescription.value=d.App.map.description,this.ctrlGridVisible.checked=d.App.map.settings.grid.visible,this.ctrlGridOrigin.checked=d.App.map.settings.grid.origin,this.ctrlGridSnap.checked=d.App.map.settings.grid.snap,this.ctrlGridSize.value=d.App.map.settings.grid.size,this.ctrlRoomWidth.value=d.App.map.settings.room.width,this.ctrlRoomHeight.value=d.App.map.settings.room.height,this.ctrlRoomLinewidth.value=d.App.map.settings.room.lineWidth,this.ctrlRoomRounding.value=d.App.map.settings.room.rounding,this.ctrlRoomDarknessSize.value=d.App.map.settings.room.darknessSize,this.setRoomPickerColor(),this.ctrlConnectorLinewidth.value=d.App.map.settings.connector.lineWidth,this.ctrlConnectorStalk.value=d.App.map.settings.connector.stalk,this.ctrlConnectorLabelDistance.value=d.App.map.settings.connector.labelDistance,this.ctrlConnectorArrowSize.value=d.App.map.settings.connector.arrowSize,this.ctrlConnectorCurve.checked=d.App.map.settings.connector.isCurve,this.ctrlConnectorCurveStrength.value=Math.floor(10*d.App.map.settings.connector.curveStrength),this.connectorColorPicker.color=d.App.map.settings.connector.color,this.ctrlNoteWidth.value=d.App.map.settings.note.width,this.ctrlNoteHeight.value=d.App.map.settings.note.height,this.ctrlNoteLinewidth.value=d.App.map.settings.note.lineWidth,this.ctrlNoteRounding.value=d.App.map.settings.note.rounding,this.setNotePickerColor(),this.ctrlBlockWidth.value=d.App.map.settings.block.width,this.ctrlBlockHeight.value=d.App.map.settings.block.height,this.ctrlBlockLinewidth.value=d.App.map.settings.block.lineWidth,this.ctrlBlockRounding.value=d.App.map.settings.block.rounding,this.setBlockPickerColor()):this.close())},e.prototype.onRoomColorButton=function(e){this.roomColorButtons.forEach(function(e){e.elem.classList.remove("selected")}),e.elem.classList.add("selected"),this.roomColorType=e.elem.dataset.type,this.setRoomPickerColor()},e.prototype.setRoomPickerColor=function(){"fill"==this.roomColorType&&(this.roomColorPicker.color=d.App.map.settings.room.fillColor),"border"==this.roomColorType&&(this.roomColorPicker.color=d.App.map.settings.room.borderColor),"name"==this.roomColorType&&(this.roomColorPicker.color=d.App.map.settings.room.nameColor),"subtitle"==this.roomColorType&&(this.roomColorPicker.color=d.App.map.settings.room.subtitleColor),"dark"==this.roomColorType&&(this.roomColorPicker.color=d.App.map.settings.room.darkColor),"start"==this.roomColorType&&(this.roomColorPicker.color=d.App.map.settings.room.startRoomColor),"end"==this.roomColorType&&(this.roomColorPicker.color=d.App.map.settings.room.endRoomColor)},e.prototype.setRoomColor=function(e){"fill"==this.roomColorType&&(d.App.map.settings.room.fillColor=e),"border"==this.roomColorType&&(d.App.map.settings.room.borderColor=e),"name"==this.roomColorType&&(d.App.map.settings.room.nameColor=e),"subtitle"==this.roomColorType&&(d.App.map.settings.room.subtitleColor=e),"dark"==this.roomColorType&&(d.App.map.settings.room.darkColor=e),"start"==this.roomColorType&&(d.App.map.settings.room.startRoomColor=e),"end"==this.roomColorType&&(d.App.map.settings.room.endRoomColor=e)},e.prototype.onNoteColorButton=function(e){this.noteColorButtons.forEach(function(e){e.elem.classList.remove("selected")}),e.elem.classList.add("selected"),this.noteColorType=e.elem.dataset.type,this.setNotePickerColor()},e.prototype.setNotePickerColor=function(){"fill"==this.noteColorType&&(this.noteColorPicker.color=d.App.map.settings.note.fillColor),"border"==this.noteColorType&&(this.noteColorPicker.color=d.App.map.settings.note.borderColor),"text"==this.noteColorType&&(this.noteColorPicker.color=d.App.map.settings.note.textColor)},e.prototype.setNoteColor=function(e){"fill"==this.noteColorType&&(d.App.map.settings.note.fillColor=e),"border"==this.noteColorType&&(d.App.map.settings.note.borderColor=e),"text"==this.noteColorType&&(d.App.map.settings.note.textColor=e)},e.prototype.onBlockColorButton=function(e){this.blockColorButtons.forEach(function(e){e.elem.classList.remove("selected")}),e.elem.classList.add("selected"),this.blockColorType=e.elem.dataset.type,this.setBlockPickerColor()},e.prototype.setBlockPickerColor=function(){"fill"==this.blockColorType&&(this.blockColorPicker.color=d.App.map.settings.block.fillColor),"border"==this.blockColorType&&(this.blockColorPicker.color=d.App.map.settings.block.borderColor)},e.prototype.setBlockColor=function(e){"fill"==this.blockColorType&&(d.App.map.settings.block.fillColor=e),"border"==this.blockColorType&&(d.App.map.settings.block.borderColor=e)},e}(o.Panel),e("MapPanel",s)}}}),System.register("io/mapXML",["models/map","models/room","models/connector","enums/enums"],function(e,t){"use strict";var a,p,d,u,n;t&&t.id;return{setters:[function(e){a=e},function(e){p=e},function(e){d=e},function(e){u=e}],execute:function(){n=function(){function e(){}return e.getAttr=function(e,t,n,o){var i=e.getAttribute(t);return i?(o&&(i=o(i)),i):n},e.getContent=function(e,t,n,o){var i=e.querySelector(t);if(!i)return n;var s=i.textContent;return o&&(s=o(s)),s},e.loadRoom=function(e,t){var n=new p.Room(e.settings);e.add(n),n.id=this.getAttr(t,"id",0,parseInt),n.x=this.getAttr(t,"x",0,parseFloat),n.y=this.getAttr(t,"y",0,parseFloat),n.name=this.getAttr(t,"name",""),n.subtitle=this.getAttr(t,"subtitle",""),n.description=this.getAttr(t,"description",""),n.width=this.getAttr(t,"w",e.settings.room.width,parseFloat),n.height=this.getAttr(t,"h",e.settings.room.height,parseFloat),n.lineStyle=this.getAttr(t,"borderstyle",e.settings.room.lineStyle,function(e){return u.LineStyle.fromString(e)}),n.dark=this.getAttr(t,"isDark",!1,function(e){return"yes"==e}),n.endroom=this.getAttr(t,"isEndRoom",!1,function(e){return"yes"==e}),n.fillColor=this.getAttr(t,"roomFill",e.settings.room.fillColor),n.borderColor=this.getAttr(t,"roomBorder",e.settings.room.borderColor),n.nameColor=this.getAttr(t,"roomLargeText",e.settings.room.nameColor),n.subtitleColor=this.getAttr(t,"roomSubtitleColor",e.settings.room.subtitleColor),n.rounding=this.getAttr(t,"cornerTopLeft",e.settings.room.rounding,parseInt),"yes"==t.getAttribute("ellipse")&&(n.shape=u.RoomShape.Ellipse),"yes"==t.getAttribute("octagonal")&&(n.shape=u.RoomShape.Octagon)},e.loadConnector=function(e,t){var n=new d.Connector(e.settings);e.add(n),n.id=this.getAttr(t,"id",0,parseInt),n.name=this.getAttr(t,"name",""),n.lineStyle=this.getAttr(t,"style",e.settings.connector.lineStyle,function(e){return"dashed"==e?u.LineStyle.Dash:u.LineStyle.Solid});t.querySelectorAll("dock");for(var o=!1,i=0;i<t.children.length;i++){var s=t.children[i];if("dock"==s.nodeName){var r=e.findById(parseInt(s.getAttribute("id")),p.Room),l=u.Direction.fromString(s.getAttribute("port"));o?(n.dockEnd=r,n.endDir=l):(n.dockStart=r,n.startDir=l,o=!0)}else if("point"==s.nodeName){var a=parseFloat(s.getAttribute("x")),c=parseFloat(s.getAttribute("y"));o?(n.endX=a,n.endY=c):(n.startX=a,n.startY=c,o=!0)}}},e.load=function(e){var t=(new DOMParser).parseFromString(e,"text/xml"),n=new a.Map,o=t.querySelector("map"),i=t.querySelector("trizbort");n.title=this.getContent(i,"info title",""),n.author=this.getContent(i,"info author",""),n.description=this.getContent(i,"info description",""),n.settings.grid.visible=this.getContent(i,"settings grid visible",n.settings.grid.visible,function(e){return"yes"==e}),n.settings.grid.origin=this.getContent(i,"settings grid showOrigin",n.settings.grid.origin,function(e){return"yes"==e}),n.settings.grid.snap=this.getContent(i,"settings grid snapTo",n.settings.grid.snap,function(e){return"yes"==e}),n.settings.grid.size=this.getContent(i,"settings grid size",n.settings.grid.size,parseInt),n.settings.room.borderColor=this.getContent(i,"settings colors border",n.settings.room.borderColor),n.settings.room.subtitleColor=this.getContent(i,"settings colors subTitle",n.settings.room.subtitleColor),n.settings.room.startRoomColor=this.getContent(i,"settings colors startRoom",n.settings.room.startRoomColor),n.settings.room.endRoomColor=this.getContent(i,"settings colors endRoom",n.settings.room.endRoomColor),n.settings.room.shape=this.getContent(i,"settings rooms defaultRoomShape",n.settings.room.shape,function(e){var t=parseInt(e);return 0<t&&t--,t}),n.settings.connector.color=this.getContent(i,"settings colors line",n.settings.connector.color),n.settings.connector.lineWidth=this.getContent(i,"settings lines width",n.settings.connector.lineWidth,parseInt),n.settings.connector.stalk=this.getContent(i,"settings rooms connectionStalkLength",n.settings.connector.stalk,parseInt);for(var s=o.querySelectorAll("room"),r=0;r<s.length;r++)this.loadRoom(n,s[r]);var l=o.querySelectorAll("line");for(r=0;r<l.length;r++)this.loadConnector(n,l[r]);return n},e}(),e("MapXMLLoader",n)}}}),System.register("io/mapJSON",["models/map","models/room","models/note","models/connector","models/block"],function(e,t){"use strict";var i,s,r,l,a,n;t&&t.id;return{setters:[function(e){i=e},function(e){s=e},function(e){r=e},function(e){l=e},function(e){a=e}],execute:function(){n=function(){function e(){}return e.save=function(e){var t=1;return e.elements.forEach(function(e){return e.id=t++}),JSON.stringify(e,function(e,t){if("map"!=e)return"dockStart"==e?null==this.dockStart?0:this.dockStart.id:"dockEnd"==e?null==this.dockEnd?0:this.dockEnd.id:t})},e.clone=function(e,t){for(var n=Object.keys(t),o=0;o<n.length;o++)e[n[o]]=t[n[o]];return e},e.load=function(e){var n=this,o=this.clone(new i.Map,JSON.parse(e)),t=o.elements;return o.elements=new Array,t.forEach(function(e){var t=null;if("Room"==e.type)t=n.clone(new s.Room(o.settings),e);else if("Note"==e.type)t=n.clone(new r.Note(o.settings),e);else if("Block"==e.type)t=n.clone(new a.Block(o.settings),e);else{if("Connector"!=e.type)throw new TypeError("Element type "+e.type+" is unknown.");t=n.clone(new l.Connector(o.settings),e)}o.add(t)}),o.elements.forEach(function(e){e instanceof l.Connector&&(0!=e.dockStart?e.dockStart=o.findById(e.dockStart,s.Room):e.dockStart=null,0!=e.dockEnd?e.dockEnd=o.findById(e.dockEnd,s.Room):e.dockEnd=null)}),o},e}(),e("MapJSON",n)}}}),System.register("panels/menuPanel/menuPanel",["app","controls/window","io/mapXML","dispatcher","enums/enums","io/mapJSON","panels/panels","models/map"],function(e,t){"use strict";var n,o,i,s,r,l,a,c,p;t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e},function(e){s=e},function(e){r=e},function(e){l=e},function(e){a=e},function(e){c=e}],execute:function(){p=function(t){function e(){var e=t.call(this,"menupanel",Handlebars.templates.menuPanel,{})||this;return document.querySelector("#menu").addEventListener("click",function(){e.toggle()}),e.inputLoad=document.getElementById("inputLoad"),e.inputImport=document.getElementById("inputImport"),e.createMenuItem("#menu-new",function(){e.actionNewMap()}),e.createMenuItem("#menu-load",function(){e.actionLoadMap()}),e.createMenuItem("#menu-save",function(){e.actionSaveMap()}),e.createMenuItem("#menu-import",function(){e.actionImportMap()}),e.createMenuItem("#menu-map",function(){e.actionMapSettings()}),e.createMenuItem("#menu-export"),e.createMenuItem("#menu-export-tads",function(){e.actionExportTads()}),e.inputLoad.addEventListener("change",function(){e.load(e.inputLoad.files,e.loadMap)}),e.inputImport.addEventListener("change",function(){e.load(e.inputImport.files,e.importMap)}),e}return __extends(e,t),e.prototype.createMenuItem=function(e,t){var n=document.querySelector(e);t&&n.addEventListener("click",t),n.addEventListener("click",function(){n.classList.toggle("open")})},e.prototype.actionNewMap=function(){new o.Window("New map","This will erase all editor contents. Proceed?",function(){n.App.map=new c.Map,s.Dispatcher.notify(r.AppEvent.Load,null)},function(){})},e.prototype.actionLoadMap=function(){this.inputLoad.click()},e.prototype.actionSaveMap=function(){var e=l.MapJSON.save(n.App.map),t=new Blob([e],{type:"text/plain; charset:utf-8"});window.saveAs(t,"map.json")},e.prototype.actionImportMap=function(){this.inputImport.click()},e.prototype.load=function(e,t){if(0!=e.length){var n=e[0],o=new FileReader;o.addEventListener("load",function(){t(o.result)}),o.readAsText(n)}},e.prototype.loadMap=function(e){var t=null;try{t=l.MapJSON.load(e)}catch(e){return void new o.Window("Map loading error","Unfortunately, an error occurred and map loading could not proceed. Perhaps the map file is in the wrong format?",!0,!1)}n.App.map=t,s.Dispatcher.notify(r.AppEvent.Load,null)},e.prototype.importMap=function(e){var t=null;try{t=i.MapXMLLoader.load(e)}catch(e){return void new o.Window("Map import error","Unfortunately, an error occurred and map import could not proceed. Perhaps the map file is in the wrong format?",!0,!1)}n.App.map=t,s.Dispatcher.notify(r.AppEvent.Load,null)},e.prototype.actionMapSettings=function(){s.Dispatcher.notify(r.AppEvent.More,n.App.map)},e.prototype.actionExportTads=function(){},e}(a.Panel),e("MenuPanel",p)}}}),System.register("panels/notePanel/notePanel",["dispatcher","enums/appEvent","models/note","enums/enums","panels/panels","controls/controls"],function(e,t){"use strict";var r,o,i,l,n,a,s;t&&t.id;return{setters:[function(e){r=e},function(e){o=e},function(e){i=e},function(e){l=e},function(e){n=e},function(e){a=e}],execute:function(){s=function(s){function e(){var n=s.call(this,"notepanel",Handlebars.templates.notePanel,{})||this;r.Dispatcher.subscribe(n),n.ctrlText=new a.IdTextarea("#notepanel .js-note-text").addEventListener("input",function(){n.note.text=n.ctrlText.value}),n.colorPicker=new a.IdColorPicker("#notepanel .js-note-color").addEventListener("change",function(){n.setNoteColor(n.colorPicker.color)}),n.ctrlShapeRectangle=new a.IdPopup("#notepanel .js-note-shape-rectangle").addEventListener("click",function(){n.note.shape=l.RoomShape.Rectangle}),n.ctrlShapeEllipse=new a.IdPopup("#notepanel .js-note-shape-ellipse").addEventListener("click",function(){n.note.shape=l.RoomShape.Ellipse}),n.ctrlShapeOctagon=new a.IdPopup("#notepanel .js-note-shape-octagon").addEventListener("click",function(){n.note.shape=l.RoomShape.Octagon}),n.ctrlRounding=new a.IdRange("#notepanel .js-note-rounding").addEventListener("input",function(){n.note.rounding=n.ctrlRounding.value});var o=document.querySelectorAll("#notepanel .colortype");n.colorButtons=new Array;for(var e=function(e){var t=new a.IdPopup(o[e]);t.elem.classList.contains("selected")&&(i.colorType=t.elem.dataset.type),i.colorButtons.push(t),o[e].addEventListener("click",function(){n.onColorButton(t)})},i=this,t=0;t<o.length;t++)e(t);return n}return __extends(e,s),e.prototype.notify=function(e,t){if(e==o.AppEvent.Select&&this.close(),e==o.AppEvent.More)if(t instanceof i.Note){var n=t;this.note=n,this.open(),this.ctrlText.value=n.text,this.ctrlRounding.value=n.rounding,this.setColor()}else this.close()},e.prototype.onColorButton=function(e){this.colorButtons.forEach(function(e){e.elem.classList.remove("selected")}),e.elem.classList.add("selected"),this.colorType=e.elem.dataset.type,this.setColor()},e.prototype.setColor=function(){"fill"==this.colorType&&(this.colorPicker.color=this.note.fillColor),"border"==this.colorType&&(this.colorPicker.color=this.note.borderColor),"text"==this.colorType&&(this.colorPicker.color=this.note.textColor)},e.prototype.setNoteColor=function(e){"fill"==this.colorType&&(this.note.fillColor=e),"border"==this.colorType&&(this.note.borderColor=e),"text"==this.colorType&&(this.note.textColor=e)},e}(n.Panel),e("NotePanel",s)}}}),System.register("panels/roomPanel/roomPanel",["dispatcher","enums/appEvent","models/room","enums/enums","panels/panels","controls/controls"],function(e,t){"use strict";var r,o,i,l,n,a,s;t&&t.id;return{setters:[function(e){r=e},function(e){o=e},function(e){i=e},function(e){l=e},function(e){n=e},function(e){a=e}],execute:function(){s=function(s){function e(){var n=s.call(this,"roompanel",Handlebars.templates.roomPanel,{})||this;r.Dispatcher.subscribe(n),n.ctrlName=new a.IdInput("#roompanel .js-room-name").addEventListener("input",function(){n.room.name=n.ctrlName.value}),n.ctrlSubtitle=new a.IdInput("#roompanel .js-room-subtitle").addEventListener("input",function(){n.room.subtitle=n.ctrlSubtitle.value}),n.ctrlDark=new a.IdCheck("#roompanel .js-room-dark").addEventListener("input",function(){n.room.dark=n.ctrlDark.checked}),n.ctrlStartroom=new a.IdCheck("#roompanel .js-room-startroom").addEventListener("input",function(){n.room.setStartRoom(n.ctrlStartroom.checked)}),n.ctrlEndroom=new a.IdCheck("#roompanel .js-room-endroom").addEventListener("input",function(){n.room.endroom=n.ctrlEndroom.checked}),n.ctrlDescription=new a.IdTextarea("#roompanel .js-room-description").addEventListener("input",function(){n.room.description=n.ctrlDescription.value}),n.colorPicker=new a.IdColorPicker("#roompanel .js-room-color").addEventListener("change",function(){n.setRoomColor(n.colorPicker.color)}),n.ctrlShapeRectangle=new a.IdPopup("#roompanel .js-room-shape-rectangle").addEventListener("click",function(){n.room.shape=l.RoomShape.Rectangle}),n.ctrlShapeEllipse=new a.IdPopup("#roompanel .js-room-shape-ellipse").addEventListener("click",function(){n.room.shape=l.RoomShape.Ellipse}),n.ctrlShapeOctagon=new a.IdPopup("#roompanel .js-room-shape-octagon").addEventListener("click",function(){n.room.shape=l.RoomShape.Octagon}),n.ctrlRounding=new a.IdRange("#roompanel .js-room-rounding").addEventListener("input",function(){n.room.rounding=n.ctrlRounding.value});var o=document.querySelectorAll("#roompanel .colortype");n.colorButtons=new Array;for(var e=function(e){var t=new a.IdPopup(o[e]);t.elem.classList.contains("selected")&&(i.colorType=t.elem.dataset.type),i.colorButtons.push(t),o[e].addEventListener("click",function(){n.onColorButton(t)})},i=this,t=0;t<o.length;t++)e(t);return n}return __extends(e,s),e.prototype.notify=function(e,t){if(e==o.AppEvent.Select&&this.close(),e==o.AppEvent.More)if(t instanceof i.Room){var n=t;this.room=t,this.open(),this.ctrlName.value=n.name,this.ctrlSubtitle.value=n.subtitle,this.ctrlDark.checked=n.dark,this.ctrlStartroom.checked=n.isStartRoom(),this.ctrlEndroom.checked=n.endroom,this.ctrlRounding.value=n.rounding,this.ctrlDescription.value=n.description,this.setColor()}else this.close()},e.prototype.onColorButton=function(e){this.colorButtons.forEach(function(e){e.elem.classList.remove("selected")}),e.elem.classList.add("selected"),this.colorType=e.elem.dataset.type,this.setColor()},e.prototype.setColor=function(){"fill"==this.colorType&&(this.colorPicker.color=this.room.fillColor),"border"==this.colorType&&(this.colorPicker.color=this.room.borderColor),"name"==this.colorType&&(this.colorPicker.color=this.room.nameColor),"subtitle"==this.colorType&&(this.colorPicker.color=this.room.subtitleColor)},e.prototype.setRoomColor=function(e){"fill"==this.colorType&&(this.room.fillColor=e),"border"==this.colorType&&(this.room.borderColor=e),"name"==this.colorType&&(this.room.nameColor=e),"subtitle"==this.colorType&&(this.room.subtitleColor=e)},e}(n.Panel),e("RoomPanel",s)}}}),System.register("panels/toolPanel/toolPanel",["enums/enums","app","controls/controls"],function(e,t){"use strict";var n,o,i;t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e}],execute:function(){e("ToolPanel",function(){this.elem=document.getElementById("toolpanel"),this.elem.innerHTML=Handlebars.templates.toolPanel({}),new i.IdPopup("#toolpanel .tool-none").addEventListener("click",function(){o.App.selection.unselectAll(),o.App.mouseMode=n.MouseMode.None}),new i.IdPopup("#toolpanel .tool-room").addEventListener("click",function(){o.App.selection.unselectAll(),o.App.mouseMode=n.MouseMode.AddRoom}),new i.IdPopup("#toolpanel .tool-note").addEventListener("click",function(){o.App.selection.unselectAll(),o.App.mouseMode=n.MouseMode.AddNote}),new i.IdPopup("#toolpanel .tool-block").addEventListener("click",function(){o.App.selection.unselectAll(),o.App.mouseMode=n.MouseMode.AddBlock})})}}}),System.register("panels/panels",["panels/panel","panels/connectorPanel/connectorPanel","panels/mapPanel/mapPanel","panels/menuPanel/menuPanel","panels/notePanel/notePanel","panels/roomPanel/roomPanel","panels/toolPanel/toolPanel"],function(o,e){"use strict";e&&e.id;function t(e){var t={};for(var n in e)"default"!==n&&(t[n]=e[n]);o(t)}return{setters:[function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)},function(e){t(e)}],execute:function(){}}}),System.register("selection",["dispatcher","enums/enums"],function(e,t){"use strict";var n,o,i;t&&t.id;return{setters:[function(e){n=e},function(e){o=e}],execute:function(){i=function(){function e(){this.list=new Array}return e.prototype.isEmpty=function(){return 0==this.list.length},e.prototype.isSingle=function(){return 1==this.list.length},e.prototype.isMultiple=function(){return 1<this.list.length},e.prototype.size=function(){return this.list.length},e.prototype.first=function(){return this.list[0]},e.prototype.get=function(){return this.list},e.prototype.clear=function(){this.list.length=0},e.prototype.unselectAll=function(){this.list.forEach(function(e){e.unselect()}),this.list.length=0,n.Dispatcher.notify(o.AppEvent.Select,null)},e.prototype.select=function(e){this.unselectAll(),this.add([e])},e.prototype.add=function(e){var t=this;e.forEach(function(e){e.select(),t.list.push(e)}),n.Dispatcher.notify(o.AppEvent.Select,e[0].getModel())},e}(),e("Selection",i)}}}),System.register("popups/blockPopup/blockPopup",["app","dispatcher","enums/enums","views/blockView","popups/popups","controls/controls"],function(e,t){"use strict";var n,s,r,o,i,l,a;t&&t.id;return{setters:[function(e){n=e},function(e){s=e},function(e){r=e},function(e){o=e},function(e){i=e},function(e){l=e}],execute:function(){a=function(t){function e(){var n=t.call(this,"blockpopup",Handlebars.templates.blockPopup,{colors:r.Values.COLORS_STANDARD})||this;s.Dispatcher.subscribe(n),new l.IdPopup("#blockpopup .js-color"),new l.IdPopup("#blockpopup .js-line"),new l.IdPopup("#blockpopup .js-position"),new l.IdPopup("#blockpopup .js-delete").addEventListener("click",function(){n.deleteBlock()}),new l.IdPopup("#blockpopup .js-more").addEventListener("click",function(){n.showMore()});for(var o=n.elem.querySelectorAll(".js-color id-popup"),e=function(){var e=new l.IdPopup(o[i]),t=r.Values.COLORS_STANDARD[i];e.backgroundColor=t,e.addEventListener("click",function(){n.setColor(t)})},i=0;i<o.length;i++)e();return new l.IdPopup("#blockpopup .js-linestyle-solid").addEventListener("click",function(){n.block.lineStyle=r.LineStyle.Solid}),new l.IdPopup("#blockpopup .js-linestyle-dash").addEventListener("click",function(){n.block.lineStyle=r.LineStyle.Dash}),new l.IdPopup("#blockpopup .js-linestyle-dashdot").addEventListener("click",function(){n.block.lineStyle=r.LineStyle.DashDot}),new l.IdPopup("#blockpopup .js-linestyle-dashdotdot").addEventListener("click",function(){n.block.lineStyle=r.LineStyle.DashDotDot}),new l.IdPopup("#blockpopup .js-linestyle-dot").addEventListener("click",function(){n.block.lineStyle=r.LineStyle.Dot}),new l.IdPopup("#blockpopup .js-linestyle-none").addEventListener("click",function(){n.block.lineStyle=r.LineStyle.None}),n.ctrlLinewidth=new l.IdRange("#blockpopup .js-linewidth").addEventListener("input",function(){n.block.lineWidth=n.ctrlLinewidth.value}),n.elem.querySelector(".js-front").addEventListener("click",function(){n.block.bringToFront(),s.Dispatcher.notify(r.AppEvent.Load,null)}),n.elem.querySelector(".js-forward").addEventListener("click",function(){n.block.bringForward(),s.Dispatcher.notify(r.AppEvent.Load,null)}),n.elem.querySelector(".js-backward").addEventListener("click",function(){n.block.sendBackward(),s.Dispatcher.notify(r.AppEvent.Load,null)}),n.elem.querySelector(".js-back").addEventListener("click",function(){n.block.sendToBack(),s.Dispatcher.notify(r.AppEvent.Load,null)}),n}return __extends(e,t),e.prototype.notify=function(e,t){e!=r.AppEvent.MouseMove&&e!=r.AppEvent.Select||this.toggle()},e.prototype.setColor=function(e){this.block.fillColor=e},e.prototype.deleteBlock=function(){n.App.pushUndo(),this.block.delete(),this.toggle()},e.prototype.showMore=function(){s.Dispatcher.notify(r.AppEvent.More,this.block)},e.prototype.toggle=function(){if(n.App.selection.isSingle()&&n.App.selection.first()instanceof o.BlockView&&n.App.mouseMode==r.MouseMode.None){this.block=n.App.selection.first().getModel(),this.elem.style.left=n.App.canvas.offsetWidth/2+n.App.centerX+this.block.x*n.App.zoom+"px",this.elem.style.top=n.App.canvas.offsetHeight/2+n.App.centerY+this.block.y-64+"px",this.elem.style.display="flex";for(var e=this.elem.querySelectorAll(".popup-overlay"),t=0;t<e.length;t++)e[t].style.display="none";this.ctrlLinewidth.value=this.block.lineWidth}else this.elem.style.display="none"},e}(i.Popup),e("BlockPopup",a)}}}),System.register("panels/blockPanel/blockPanel",["dispatcher","enums/appEvent","models/block","enums/enums","panels/panels","controls/controls"],function(e,t){"use strict";var r,o,i,l,n,a,s;t&&t.id;return{setters:[function(e){r=e},function(e){o=e},function(e){i=e},function(e){l=e},function(e){n=e},function(e){a=e}],execute:function(){s=function(s){function e(){var n=s.call(this,"blockpanel",Handlebars.templates.blockPanel,{})||this;r.Dispatcher.subscribe(n),n.colorPicker=new a.IdColorPicker("#blockpanel .js-block-color").addEventListener("change",function(){n.setNoteColor(n.colorPicker.color)}),n.ctrlShapeRectangle=new a.IdPopup("#blockpanel .js-block-shape-rectangle").addEventListener("click",function(){n.block.shape=l.RoomShape.Rectangle}),n.ctrlShapeEllipse=new a.IdPopup("#blockpanel .js-block-shape-ellipse").addEventListener("click",function(){n.block.shape=l.RoomShape.Ellipse}),n.ctrlShapeOctagon=new a.IdPopup("#blockpanel .js-block-shape-octagon").addEventListener("click",function(){n.block.shape=l.RoomShape.Octagon}),n.ctrlRounding=new a.IdRange("#blockpanel .js-block-rounding").addEventListener("input",function(){n.block.rounding=n.ctrlRounding.value});var o=document.querySelectorAll("#blockpanel .colortype");n.colorButtons=new Array;for(var e=function(e){var t=new a.IdPopup(o[e]);t.elem.classList.contains("selected")&&(i.colorType=t.elem.dataset.type),i.colorButtons.push(t),o[e].addEventListener("click",function(){n.onColorButton(t)})},i=this,t=0;t<o.length;t++)e(t);return n}return __extends(e,s),e.prototype.notify=function(e,t){if(e==o.AppEvent.Select&&this.close(),e==o.AppEvent.More)if(t instanceof i.Block){var n=t;this.block=n,this.open(),this.ctrlRounding.value=n.rounding,this.setColor()}else this.close()},e.prototype.onColorButton=function(e){this.colorButtons.forEach(function(e){e.elem.classList.remove("selected")}),e.elem.classList.add("selected"),this.colorType=e.elem.dataset.type,this.setColor()},e.prototype.setColor=function(){"fill"==this.colorType&&(this.colorPicker.color=this.block.fillColor),"border"==this.colorType&&(this.colorPicker.color=this.block.borderColor)},e.prototype.setNoteColor=function(e){"fill"==this.colorType&&(this.block.fillColor=e),"border"==this.colorType&&(this.block.borderColor=e)},e}(n.Panel),e("BlockPanel",s)}}}),System.register("app",["models/map","dispatcher","enums/enums","editor","controls/controls","popups/popups","panels/panels","io/mapJSON","selection","popups/blockPopup/blockPopup","panels/blockPanel/blockPanel"],function(e,t){"use strict";var n,o,i,s,r,l,a,c,p,d,u,h;t&&t.id;return{setters:[function(e){n=e},function(e){o=e},function(e){i=e},function(e){s=e},function(e){r=e},function(e){l=e},function(e){a=e},function(e){c=e},function(e){p=e},function(e){d=e},function(e){u=e}],execute:function(){h=function(){function e(){}return e.initialize=function(){e.canvas=document.getElementById("canvas"),e.selection=new p.Selection;new s.Editor,new a.ConnectorPanel,new l.ConnectorPopup,new a.MapPanel,new a.MenuPanel,new a.NotePanel,new l.NotePopup,new a.ToolPanel,new u.BlockPanel,new l.RoomPopup,new a.RoomPanel,new d.BlockPopup;i.Values.BITMAP_ASSETS.forEach(function(e){(new Image).src="assets/"+e+".jpg"}),r.Tabs.initialize()},e.pushUndo=function(){this.undoStack.push(c.MapJSON.save(this.map)),100<this.undoStack.length&&this.undoStack.shift()},e.undo=function(){if(0!=this.undoStack.length){var e=this.undoStack.pop();this.map=c.MapJSON.load(e),o.Dispatcher.notify(i.AppEvent.Load,null)}},e.map=new n.Map,e.zoom=1,e.centerX=0,e.centerY=0,e.mouseMode=i.MouseMode.None,e.undoStack=new Array,e}(),e("App",h)}}}),function(){var e=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t.idCheck=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return'<div class="form-check">\r\n  <input type="checkbox" value="">\r\n  <label>'+e.escapeExpression("function"==typeof(s=null!=(s=n.label||(null!=t?t.label:t))?s:n.helperMissing)?s.call(t,{name:"label",hash:{},data:i}):s)+"</label>\r\n</div>"},useData:!0}),t.idColorPicker=e({1:function(e,t,n,o,i){return'      <id-popup class="alpha"></id-popup>\r\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return'<div class="color-picker">\r\n  <div>\r\n    <div class="hsl">\r\n      <canvas></canvas>\r\n      <div class="selection">\r\n        <div class="current-color"></div>\r\n        <div class="hover-color"></div>\r\n      </div>\r\n    </div>\r\n    <canvas></canvas>\r\n  </div>\r\n  <p>Recent colors</p>\r\n  <div class="recent">\r\n'+(null!=(s=n.each.call(t,null!=t?t.recentcolors:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?s:"")+'  </div>\r\n  <p>Standard colors</p>\r\n  <div class="standard">\r\n'+(null!=(s=n.each.call(t,null!=t?t.standardcolors:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?s:"")+"  </div>\r\n</div>"},useData:!0}),t.idConnectorType=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s,r=n.helperMissing,l="function",a=e.escapeExpression;return'<id-radio class="js-default" data-label="Default" data-name="'+a(typeof(s=null!=(s=n.name||(null!=t?t.name:t))?s:r)===l?s.call(t,{name:"name",hash:{},data:i}):s)+'"></id-radio> \r\n<id-radio class="js-in" data-label="In" data-name="'+a(typeof(s=null!=(s=n.name||(null!=t?t.name:t))?s:r)===l?s.call(t,{name:"name",hash:{},data:i}):s)+'"></id-radio>\r\n<id-radio class="js-out" data-label="Out" data-name="'+a(typeof(s=null!=(s=n.name||(null!=t?t.name:t))?s:r)===l?s.call(t,{name:"name",hash:{},data:i}):s)+'"></id-radio>\r\n<id-radio class="js-up" data-label="Up" data-name="'+a(typeof(s=null!=(s=n.name||(null!=t?t.name:t))?s:r)===l?s.call(t,{name:"name",hash:{},data:i}):s)+'"></id-radio>\r\n<id-radio class="js-down" data-label="Down" data-name="'+a(typeof(s=null!=(s=n.name||(null!=t?t.name:t))?s:r)===l?s.call(t,{name:"name",hash:{},data:i}):s)+'"></id-radio>'},useData:!0}),t.idInput=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return'<div class="form-group">\r\n  <label>'+e.escapeExpression("function"==typeof(s=null!=(s=n.label||(null!=t?t.label:t))?s:n.helperMissing)?s.call(t,{name:"label",hash:{},data:i}):s)+'</label>\r\n  <input type="text">\r\n  <div class="input-line"></div>\r\n</div>'},useData:!0}),t.idPopup=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){return'<div class="popup-button">\r\n</div>'},useData:!0}),t.idRadio=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s,r=n.helperMissing,l="function",a=e.escapeExpression;return'<div class="form-check">\r\n  <input type="radio" name="'+a(typeof(s=null!=(s=n.name||(null!=t?t.name:t))?s:r)===l?s.call(t,{name:"name",hash:{},data:i}):s)+'">\r\n  <label>'+a(typeof(s=null!=(s=n.label||(null!=t?t.label:t))?s:r)===l?s.call(t,{name:"label",hash:{},data:i}):s)+"</label>\r\n</div>"},useData:!0}),t.idRange=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s,r=n.helperMissing,l="function",a=e.escapeExpression;return'<div style="display: flex; flex-direction: row; flex-wrapping: nowrap; align-items: center">\r\n  <input type="range" min="'+a(typeof(s=null!=(s=n.min||(null!=t?t.min:t))?s:r)===l?s.call(t,{name:"min",hash:{},data:i}):s)+'" max="'+a(typeof(s=null!=(s=n.max||(null!=t?t.max:t))?s:r)===l?s.call(t,{name:"max",hash:{},data:i}):s)+'">\r\n  <div class="range-label" style="width:40px; text-align:right">0</div>\r\n</div>'},useData:!0}),t.idTextarea=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return'<div class="form-group" style="margin-top:25px">\r\n  <label>'+e.escapeExpression("function"==typeof(s=null!=(s=n.label||(null!=t?t.label:t))?s:n.helperMissing)?s.call(t,{name:"label",hash:{},data:i}):s)+'</label>\r\n  <textarea style="height:400px"></textarea>\r\n  <div class="input-line"></div>\r\n</div>'},useData:!0}),t.blockPanel=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return(null!=(s=e.invokePartial(o.closePanel,t,{name:"closePanel",data:i,helpers:n,partials:o,decorators:e.decorators}))?s:"")+'\r\n<h2>Block</h2>\r\n\r\n<div class="tabs">\r\n  <div class="tab selected" data-body="tab-block-info">Info</div>\r\n  <div class="tab" data-body="tab-block-color">Color</div>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-block-info">\r\n  <label style="margin-top:25px">Block shape</label> \r\n  <div style="display: flex; flex-wrap: no-wrap">\r\n    <id-popup class="js-block-shape-rectangle">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#rectangle"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-block-shape-ellipse">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#ellipse"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-block-shape-octagon">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#octagon"></use></svg>\r\n    </id-popup>\r\n  </div>    \r\n  <label>Rectangle rounding</label>\r\n  <id-range class="js-block-rounding" data-min="0" data-max="100"></id-range>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-block-color">\r\n  <div style="display: flex">\r\n    <div style="display: flex; flex-direction: column; flex-wrap: wrap">\r\n      <id-popup title="Block fill" class="colortype selected" data-type="fill">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#block-fill"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Block border" class="colortype" data-type="border">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#block-border"></use></svg>\r\n      </id-popup>\r\n    </div>\r\n    <id-colorpicker class="js-block-color"></id-colorpicker>\r\n  </div>\r\n</div>'},usePartial:!0,useData:!0}),t.closePanel=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){return'<div class="panel-close">\r\n  <i class="fa fa-close"></i>\r\n</div>'},useData:!0}),t.connectorPanel=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return(null!=(s=e.invokePartial(o.closePanel,t,{name:"closePanel",data:i,helpers:n,partials:o,decorators:e.decorators}))?s:"")+'\r\n<h2>Connector</h2> \r\n\r\n<div class="tabs">\r\n  <div class="tab selected" data-body="tab-connector-info">Info</div>\r\n  <div class="tab" data-body="tab-connector-color">Color</div>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-connector-info">\r\n  <id-input class="js-connector-name" data-label="Connector name"></id-input>\r\n  <id-check class="js-connector-curve" data-label="Curve"></id-check>\r\n  <id-check class="js-connector-oneway" data-label="One way"></id-check>\r\n  <button class="btn-primary js-reverse">Reverse</button>\r\n\r\n  <div style="display: flex; margin-top: 20px">\r\n    <div style="flex: 1; display: flex; flex-direction: column; padding-right: 10px">\r\n      <label>Start type</label>\r\n      <id-connector-type class="js-connector-starttype"></id-connector-type>\r\n      <id-input style="margin-top:20px" class="js-connector-startlabel" data-label="Start label"></id-input>\r\n    </div>\r\n    <div style="flex: 1; display: flex; flex-direction: column; padding-left: 10px">\r\n      <label>End type</label>\r\n      <id-connector-type class="js-connector-endtype"></id-connector-type>\r\n      <id-input style="margin-top:20px" class="js-connector-endlabel" data-label="End label"></id-input>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-connector-color">\r\n  <id-colorpicker class="js-connector-color"></id-colorpicker>\r\n</div>'},usePartial:!0,useData:!0}),t.mapPanel=e({1:function(e,t,n,o,i){var s=e.lambda,r=e.escapeExpression;return'    <id-popup class="js-map-bg-'+r(s(t,t))+'">\r\n      <div style="width:24px; height: 24px; background-size: 24px 24px; background-image: url(\'assets/'+r(s(t,t))+".jpg');\"></div>\r\n    </id-popup>  \r\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return(null!=(s=e.invokePartial(o.closePanel,t,{name:"closePanel",data:i,helpers:n,partials:o,decorators:e.decorators}))?s:"")+'\r\n<h2>Map</h2>\r\n\r\n<div class="tabs"> \r\n  <div class="tab selected" data-body="tab-map-info">Info</div>\r\n  <div class="tab" data-body="tab-map-grid">Grid</div>\r\n  <div class="tab" data-body="tab-map-rooms">Room</div>\r\n  <div class="tab" data-body="tab-map-connectors">Line</div>\r\n  <div class="tab" data-body="tab-map-notes">Note</div>\r\n  <div class="tab" data-body="tab-map-blocks">Block</div>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-map-info">\r\n  <id-input class="js-map-title" data-label="Map title"></id-input>\r\n  <id-input class="js-map-author" data-label="Map author"></id-input>\r\n  <id-textarea class="js-map-description" data-label="Description"></id-textarea>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-map-grid">\r\n  <id-check class="js-map-grid-visible" data-label="Visible"></id-check>\r\n  <id-check class="js-map-grid-origin" data-label="Show origin"></id-check>\r\n  <id-check class="js-map-grid-snap" data-label="Snap to grid"></id-check>\r\n  <id-range class="js-map-grid-size" data-min="16" data-max="128"></id-range>\r\n\r\n  <label>Map background</label>\r\n  <div style="display:flex">\r\n    <id-popup class="js-map-bg-none"></id-popup>  \r\n'+(null!=(s=n.each.call(t,null!=t?t.assets:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?s:"")+'  </div>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-map-rooms">\r\n  <label>Default room width</label>\r\n  <id-range class=\'js-map-room-width\' data-min="64" data-max="256"></id-range>\r\n  <label>Default room height</label>\r\n  <id-range class=\'js-map-room-height\' data-min="64" data-max="256"></id-range>\r\n  <label>Default room line width</label>\r\n  <id-range class=\'js-map-room-linewidth\' data-min="1" data-max="10"></id-range>\r\n  <label>Default room rounding</label>\r\n  <id-range class=\'js-map-room-rounding\' data-min="0" data-max="30"></id-range>\r\n  <label>Darkness stripe size</label>\r\n  <id-range class=\'js-map-room-darkness-size\' data-min="50" data-max="100"></id-range>\r\n\r\n  <label>Default room shape</label>\r\n  <div style="display: flex; flex-wrap: no-wrap">\r\n    <id-popup class="js-room-shape-rectangle">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#rectangle"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-room-shape-ellipse">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#ellipse"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-room-shape-octagon">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#octagon"></use></svg>\r\n    </id-popup>\r\n  </div>  \r\n\r\n  <label>Default room border style</label>\r\n  <div style="display: flex; flex-wrap: no-wrap">\r\n    <id-popup class="js-room-linestyle-solid">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-solid"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-room-linestyle-dash">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dash"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-room-linestyle-dashdot">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdot"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-room-linestyle-dashdotdot">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdotdot"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-room-linestyle-dot">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dot"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-room-linestyle-none"></id-popup>\r\n  </div>  \r\n\r\n  <label>Default room colors</label>\r\n  <div style="display: flex">\r\n    <div style="display: flex; flex-direction: column; flex-wrap: wrap">\r\n      <id-popup title="Room fill" class="room-colortype selected" data-type="fill">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#room-fill"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Room border" class="room-colortype" data-type="border">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#room-border"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Room name" class="room-colortype" data-type="name">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#room-name"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Room subtitle" class="room-colortype" data-type="subtitle">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#room-subtitle"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Darkness stripe" class="room-colortype" data-type="dark">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#room-darkness"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Start room" class="room-colortype" data-type="start">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#room-start"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="End room" class="room-colortype" data-type="end">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#room-end"></use></svg>\r\n      </id-popup>                  \r\n    </div>\r\n    <id-colorpicker class="js-map-room-color"></id-colorpicker>\r\n  </div>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-map-connectors">\r\n  <label>Default connector line width</label>\r\n  <id-range class=\'js-map-connector-linewidth\' data-min="1" data-max="10"></id-range>  \r\n\r\n  <label>Default connector line style</label>\r\n  <div style="display: flex; flex-wrap: no-wrap">\r\n    <id-popup class="js-connector-linestyle-solid">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-solid"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-connector-linestyle-dash">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dash"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-connector-linestyle-dashdot">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdot"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-connector-linestyle-dashdotdot">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdotdot"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-connector-linestyle-dot">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dot"></use></svg>\r\n    </id-popup>\r\n  </div>\r\n\r\n  <label>Default connector stalk length</label>\r\n  <id-range class=\'js-map-connector-stalk\' data-min="16" data-max="64"></id-range>    \r\n\r\n  <label>Label distance</label>\r\n  <id-range class=\'js-map-connector-label-distance\' data-min="10" data-max="20"></id-range>    \r\n\r\n  <label>One-way arrow size</label>\r\n  <id-range class=\'js-map-connector-arrow-size\' data-min="3" data-max="10"></id-range>      \r\n\r\n  <id-check class="js-map-connector-curve" data-label="Use curves"></id-check>\r\n\r\n  <label>Default connector curve strength</label>\r\n  <id-range class=\'js-map-connector-curve-strength\' data-min="1" data-max="8"></id-range>      \r\n\r\n  <label>Default connector color</label>\r\n  <id-colorpicker class="js-map-connector-color"></id-colorpicker>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-map-notes">\r\n  <label>Default note width</label>\r\n  <id-range class=\'js-map-note-width\' data-min="64" data-max="256"></id-range>\r\n  <label>Default note height</label>\r\n  <id-range class=\'js-map-note-height\' data-min="64" data-max="256"></id-range>\r\n  <label>Default note line width</label>\r\n  <id-range class=\'js-map-note-linewidth\' data-min="1" data-max="10"></id-range>\r\n  <label>Default note rounding</label>\r\n  <id-range class=\'js-map-note-rounding\' data-min="0" data-max="30"></id-range>\r\n\r\n  <label>Default note shape</label>\r\n  <div style="display: flex; flex-wrap: no-wrap">\r\n    <id-popup class="js-note-shape-rectangle">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#rectangle"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-note-shape-ellipse">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#ellipse"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-note-shape-octagon">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#octagon"></use></svg>\r\n    </id-popup>\r\n  </div>  \r\n\r\n  <label>Default note border style</label>\r\n  <div style="display: flex; flex-wrap: no-wrap">\r\n    <id-popup class="js-note-linestyle-solid">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-solid"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-note-linestyle-dash">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dash"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-note-linestyle-dashdot">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdot"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-note-linestyle-dashdotdot">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdotdot"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-note-linestyle-dot">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dot"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-note-linestyle-none"></id-popup>\r\n  </div>  \r\n\r\n  <label>Default note colors</label>\r\n  <div style="display: flex">\r\n    <div style="display: flex; flex-direction: column; flex-wrap: wrap">\r\n      <id-popup title="Note fill" class="note-colortype selected" data-type="fill">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#note-fill"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Note border" class="note-colortype" data-type="border">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#note-border"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Note text" class="note-colortype" data-type="text">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#note-text"></use></svg>\r\n      </id-popup>\r\n    </div>\r\n    <id-colorpicker class="js-map-note-color"></id-colorpicker>  \r\n  </div>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-map-blocks">\r\n  <label>Default block width</label>\r\n  <id-range class=\'js-map-block-width\' data-min="64" data-max="256"></id-range>\r\n  <label>Default block height</label>\r\n  <id-range class=\'js-map-block-height\' data-min="64" data-max="256"></id-range>\r\n  <label>Default block line width</label>\r\n  <id-range class=\'js-map-block-linewidth\' data-min="1" data-max="10"></id-range>\r\n  <label>Default block rounding</label>\r\n  <id-range class=\'js-map-block-rounding\' data-min="0" data-max="30"></id-range>\r\n\r\n  <label>Default block shape</label>\r\n  <div style="display: flex; flex-wrap: no-wrap">\r\n    <id-popup class="js-block-shape-rectangle">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#rectangle"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-block-shape-ellipse">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#ellipse"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-block-shape-octagon">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#octagon"></use></svg>\r\n    </id-popup>\r\n  </div>  \r\n\r\n  <label>Default block border style</label>\r\n  <div style="display: flex; flex-wrap: no-wrap">\r\n    <id-popup class="js-block-linestyle-solid">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-solid"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-block-linestyle-dash">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dash"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-block-linestyle-dashdot">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdot"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-block-linestyle-dashdotdot">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdotdot"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-block-linestyle-dot">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#line-dot"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-block-linestyle-none"></id-popup>\r\n  </div>  \r\n\r\n  <label>Default block colors</label>\r\n  <div style="display: flex">\r\n    <div style="display: flex; flex-direction: column; flex-wrap: wrap">\r\n      <id-popup title="Block fill" class="block-colortype selected" data-type="fill">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#block-fill"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Block border" class="block-colortype" data-type="border">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#block-border"></use></svg>\r\n      </id-popup>\r\n    </div>\r\n    <id-colorpicker class="js-map-block-color"></id-colorpicker>  \r\n  </div>\r\n</div>'},usePartial:!0,useData:!0}),t.menuPanel=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){return'<input id="inputLoad" type="file" style="display:none" accept=".json">\r\n<input id="inputImport" type="file" style="display:none" accept=".trizbort">\r\n\r\n<div class="menuitem">\r\n  <a href="#" id="menu-new"><svg class="icon small"><use xlink:href="dist/icons.svg#map"></use></svg> New map</a>\r\n</div>\r\n<div class="menuitem">\r\n  <a href="#" id="menu-load"><svg class="icon small"><use xlink:href="dist/icons.svg#open"></use></svg> Load map</a>\r\n</div>    \r\n<div class="menuitem">\r\n  <a href="#" id="menu-import"><svg class="icon small"><use xlink:href="dist/icons.svg#open"></use></svg> Import Trizbort map</a>\r\n</div>    \r\n<div class="menuitem">\r\n  <a href="#" id="menu-save"><svg class="icon small"><use xlink:href="dist/icons.svg#save"></use></svg> Save map</a>\r\n</div>\r\n<div class="menuitem">\r\n  <a href="#" id="menu-map"><svg class="icon small"><use xlink:href="dist/icons.svg#settings"></use></svg> Map settings</a>\r\n</div>\r\n<div class="menuitem">\r\n  <a href="#" id="menu-export"><svg class="icon small"><use xlink:href="dist/icons.svg#code"></use></svg> Export</a>\r\n  <div class="menuitem">\r\n    <a href="#" id="menu-export-tads"><svg class="icon small"><use xlink:href="dist/icons.svg#code"></use></svg> TADS</a> \r\n  </div>\r\n</div>'},useData:!0}),t.notePanel=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return(null!=(s=e.invokePartial(o.closePanel,t,{name:"closePanel",data:i,helpers:n,partials:o,decorators:e.decorators}))?s:"")+'\r\n<h2>Note</h2>\r\n\r\n<div class="tabs">\r\n  <div class="tab selected" data-body="tab-note-info">Info</div>\r\n  <div class="tab" data-body="tab-note-color">Color</div>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-note-info">\r\n  <label style="margin-top:25px">Note shape</label> \r\n  <div style="display: flex; flex-wrap: no-wrap">\r\n    <id-popup class="js-note-shape-rectangle">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#rectangle"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-note-shape-ellipse">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#ellipse"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-note-shape-octagon">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#octagon"></use></svg>\r\n    </id-popup>\r\n  </div>    \r\n  <label>Rectangle rounding</label>\r\n  <id-range class="js-note-rounding" data-min="0" data-max="100"></id-range>\r\n  <id-textarea class="js-note-text" data-label="Note text"></id-textarea>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-note-color">\r\n  <div style="display: flex">\r\n    <div style="display: flex; flex-direction: column; flex-wrap: wrap">\r\n      <id-popup title="Note fill" class="colortype selected" data-type="fill">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#note-fill"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Note border" class="colortype" data-type="border">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#note-border"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Note text" class="colortype" data-type="text">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#note-text"></use></svg>\r\n      </id-popup>\r\n    </div>\r\n    <id-colorpicker class="js-note-color"></id-colorpicker>\r\n  </div>\r\n</div>'},usePartial:!0,useData:!0}),t.roomPanel=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return(null!=(s=e.invokePartial(o.closePanel,t,{name:"closePanel",data:i,helpers:n,partials:o,decorators:e.decorators}))?s:"")+'\r\n<h2>Room</h2>\r\n\r\n<div class="tabs"> \r\n  <div class="tab selected" data-body="tab-room-info">Info</div>\r\n  <div class="tab" data-body="tab-room-color">Color</div>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-room-info">\r\n  <id-input class="js-room-name" data-label="Room name"></id-input>\r\n  <in-input class="js-room-subtitle" data-label="Room subtitle"></in-input>\r\n  <id-check class="js-room-dark" data-label="Dark"></id-check>\r\n  <id-check class="js-room-startroom" data-label="Start room"></id-check>\r\n  <id-check class="js-room-endroom" data-label="End room"></id-check>\r\n\r\n  <label style="margin-top:25px">Room shape</label> \r\n  <div style="display: flex; flex-wrap: no-wrap">\r\n    <id-popup class="js-room-shape-rectangle">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#rectangle"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-room-shape-ellipse">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#ellipse"></use></svg>\r\n    </id-popup>\r\n    <id-popup class="js-room-shape-octagon">\r\n      <svg class="icon"><use xlink:href="dist/icons.svg#octagon"></use></svg>\r\n    </id-popup>\r\n  </div>    \r\n  <label>Rectangle rounding</label>\r\n  <id-range class="js-room-rounding" data-min="0" data-max="100"></id-range>\r\n\r\n  <id-textarea class="js-room-description" data-label="Room description"></id-textarea>\r\n</div>\r\n\r\n<div class="tab-body" id="tab-room-color">\r\n  <div style="display: flex">\r\n    <div style="display: flex; flex-direction: column; flex-wrap: wrap">\r\n      <id-popup title="Room fill" class="colortype selected" data-type="fill">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#room-fill"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Room border" class="colortype" data-type="border">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#room-border"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Room name" class="colortype" data-type="name">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#room-name"></use></svg>\r\n      </id-popup>\r\n      <id-popup title="Room subtitle" class="colortype" data-type="subtitle">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#room-subtitle"></use></svg>\r\n      </id-popup>\r\n    </div>\r\n    <id-colorpicker class="js-room-color"></id-colorpicker>\r\n  </div>\r\n</div>\r\n'},usePartial:!0,useData:!0}),t.toolPanel=e({compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){return'<id-popup title="Cursor" class="tool-none">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#arrow"></use></svg>\r\n</id-popup>\r\n<id-popup title="Add room (R)" class="tool-room">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#room"></use></svg>\r\n</id-popup>\r\n<id-popup title="Add note (N)" class="tool-note">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#note"></use></svg>\r\n</id-popup>\r\n<id-popup title="Add block (B)" class="tool-block">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#block"></use></svg>\r\n</id-popup>'},useData:!0}),t.blockPopup=e({1:function(e,t,n,o,i){return'        <id-popup class="alpha"></id-popup>\r\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return'<id-popup class="js-color">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#paintbrush"></use></svg>\r\n  <div class="popup-overlay" style="width:168px">\r\n    <div style="display: flex; flex-wrap: wrap">\r\n'+(null!=(s=n.each.call(t,null!=t?t.colors:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?s:"")+'    </div> \r\n  </div>      \r\n</id-popup>\r\n<id-popup class="js-line">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#line-solid"></use></svg>\r\n  <div class="popup-overlay">\r\n    <div style="display: flex; flex-wrap: no-wrap">\r\n      <id-popup class="js-linestyle-solid">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-solid"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dash">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dash"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dashdot">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdot"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dashdotdot">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdotdot"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dot">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dot"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-none"></id-popup>\r\n    </div>\r\n    <id-range class="js-linewidth" data-min="1" data-max="10"></id-range>\r\n  </div>      \r\n</id-popup>\r\n<id-popup class="js-position">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#position"></use></svg>\r\n  <div class="popup-overlay" style="width: 150px; padding-bottom: 8px">\r\n    <div class="menuitem"><a href="#" class="js-front">Bring to Front</a></div>\r\n    <div class="menuitem"><a href="#" class="js-forward">Bring Forward</a></div>\r\n    <div class="menuitem"><a href="#" class="js-backward">Send Backward</a></div>\r\n    <div class="menuitem"><a href="#" class="js-back">Send to Back</a></div>\r\n  </div>  \r\n</id-popup>\r\n<id-popup class="js-delete">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#trash"></use></svg>\r\n</id-popup>\r\n<id-popup class="js-more">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#ellipsis-h"></use></svg>\r\n</id-popup>'},useData:!0}),t.connectorPopup=e({1:function(e,t,n,o,i){return'        <id-popup class="alpha"></id-popup>\r\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return'<id-popup class="js-color">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#paintbrush"></use></svg>\r\n  <div class="popup-overlay" style="width:168px">\r\n    <div style="display: flex; flex-wrap: wrap">\r\n'+(null!=(s=n.each.call(t,null!=t?t.colors:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?s:"")+'    </div>\r\n  </div>     \r\n</id-popup>\r\n<id-popup class="js-line">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#line-solid"></use></svg>\r\n  <div class="popup-overlay">\r\n    <div style="display: flex; flex-wrap: no-wrap">\r\n      <id-popup class="js-linestyle-solid">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-solid"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dash">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dash"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dashdot">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdot"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dashdotdot">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdotdot"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dot">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dot"></use></svg>\r\n      </id-popup>\r\n    </div>\r\n    <id-range class="js-linewidth" data-min="1" data-max="10"></id-range>\r\n  </div>      \r\n</id-popup>\r\n<id-popup class="js-basic">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#font"></use></svg>\r\n  <div class="popup-overlay" style="width:168px">\r\n    <id-input class="js-name" data-label="Name"></id-input>\r\n  </div>\r\n</id-popup>\r\n<id-popup class="js-delete">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#trash"></use></svg>\r\n</id-popup>\r\n<id-popup class="js-more">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#ellipsis-h"></use></svg>\r\n</id-popup>'},useData:!0}),t.notePopup=e({1:function(e,t,n,o,i){return'        <id-popup class="alpha"></id-popup>\r\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return'<id-popup class="js-basic">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#font"></use></svg>\r\n  <div class="popup-overlay" style="width:168px">\r\n    <id-textarea class="js-text" data-label="Text"></id-textarea>\r\n  </div>\r\n</id-popup>    \r\n<id-popup class="js-color">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#paintbrush"></use></svg>\r\n  <div class="popup-overlay" style="width:168px">\r\n    <div style="display: flex; flex-wrap: wrap">\r\n'+(null!=(s=n.each.call(t,null!=t?t.colors:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?s:"")+'    </div>\r\n  </div>      \r\n</id-popup>\r\n<id-popup class="js-line">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#line-solid"></use></svg>\r\n  <div class="popup-overlay">\r\n    <div style="display: flex; flex-wrap: no-wrap">\r\n      <id-popup class="js-linestyle-solid">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-solid"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dash">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dash"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dashdot">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdot"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dashdotdot">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdotdot"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dot">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dot"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-none"></id-popup>\r\n    </div>\r\n    <id-range class="js-linewidth" data-min="1" data-max="10"></id-range>\r\n  </div>      \r\n</id-popup>\r\n<id-popup class="js-position">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#position"></use></svg>\r\n  <div class="popup-overlay" style="width: 150px; padding-bottom: 8px">\r\n    <div class="menuitem"><a href="#" class="js-front">Bring to Front</a></div>\r\n    <div class="menuitem"><a href="#" class="js-forward">Bring Forward</a></div>\r\n    <div class="menuitem"><a href="#" class="js-backward">Send Backward</a></div>\r\n    <div class="menuitem"><a href="#" class="js-back">Send to Back</a></div>\r\n  </div>  \r\n</id-popup>\r\n<id-popup class="js-delete">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#trash"></use></svg>\r\n</id-popup>\r\n<id-popup class="js-more">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#ellipsis-h"></use></svg>\r\n</id-popup>'},useData:!0}),t.roomPopup=e({1:function(e,t,n,o,i){return'        <id-popup class="alpha"></id-popup>\r\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,o,i){var s;return'<id-popup class="js-basic">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#font"></use></svg>\r\n  <div class="popup-overlay" style="width:168px">\r\n    <id-input class="js-name" data-label="Name"></id-input>\r\n    <id-input class="js-subtitle" data-label="Subtitle"></id-input>\r\n  </div>\r\n</id-popup>    \r\n<id-popup class="js-fill">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#paintbrush"></use></svg>\r\n  <div class="popup-overlay" style="width:168px">\r\n    <div style="display: flex; flex-wrap: wrap">\r\n'+(null!=(s=n.each.call(t,null!=t?t.colors:t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))?s:"")+'    </div>\r\n  </div>      \r\n</id-popup>\r\n<id-popup class="js-border">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#line-solid"></use></svg>\r\n  <div class="popup-overlay">\r\n    <div style="display: flex; flex-wrap: no-wrap">\r\n      <id-popup class="js-linestyle-solid">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-solid"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dash">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dash"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dashdot">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdot"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dashdotdot">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dashdotdot"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-dot">\r\n        <svg class="icon"><use xlink:href="dist/icons.svg#line-dot"></use></svg>\r\n      </id-popup>\r\n      <id-popup class="js-linestyle-none"></id-popup>\r\n    </div>\r\n    <id-range class="js-linewidth" data-min="1" data-max="10"></id-range>\r\n  </div>      \r\n</id-popup>\r\n<id-popup class="js-position">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#position"></use></svg>\r\n  <div class="popup-overlay" style="width: 150px; padding-bottom: 8px">\r\n    <div class="menuitem"><a href="#" class="js-front">Bring to Front</a></div>\r\n    <div class="menuitem"><a href="#" class="js-forward">Bring Forward</a></div>\r\n    <div class="menuitem"><a href="#" class="js-backward">Send Backward</a></div>\r\n    <div class="menuitem"><a href="#" class="js-back">Send to Back</a></div>\r\n  </div>  \r\n</id-popup>\r\n<id-popup class="js-delete">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#trash"></use></svg>\r\n</id-popup>\r\n<id-popup class="js-more">\r\n  <svg class="icon"><use xlink:href="dist/icons.svg#ellipsis-h"></use></svg>\r\n</id-popup>'},useData:!0})}();